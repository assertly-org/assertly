{"version":3,"file":"basebackend.js","sourceRoot":"","sources":["../src/basebackend.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,MAAM,EAAE,MAAM,sBAAsB,CAAC;AAC9C,OAAO,EAAE,SAAS,EAAE,MAAM,sBAAsB,CAAC;AACjD,OAAO,EAAE,WAAW,EAAE,MAAM,SAAS,CAAC;AAEtC,OAAO,EAAE,aAAa,EAAE,MAAM,mBAAmB,CAAC;AAOlD;;GAEG;AACH,MAAM,OAAgB,WAAW;IAO/B,8CAA8C;IAC9C,YAAmB,OAAU;QAC3B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE;YACrB,MAAM,CAAC,IAAI,CAAC,gDAAgD,CAAC,CAAC;SAC/D;QACD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;IACzC,CAAC;IAED;;OAEG;IACO,cAAc;QACtB,OAAO,IAAI,aAAa,EAAE,CAAC;IAC7B,CAAC;IAED;;OAEG;IACI,KAAK,CAAC,kBAAkB,CAAC,UAAe,EAAE,KAAuB;QACtE,MAAM,IAAI,WAAW,CAAC,sDAAsD,CAAC,CAAC;IAChF,CAAC;IAED;;OAEG;IACI,KAAK,CAAC,gBAAgB,CAAC,QAAgB,EAAE,MAAiB,EAAE,KAAuB;QACxF,MAAM,IAAI,WAAW,CAAC,oDAAoD,CAAC,CAAC;IAC9E,CAAC;IAED;;OAEG;IACI,KAAK,CAAC,SAAS,CAAC,KAAkB;QACvC,uBAAuB;QACvB,2BAA2B;QAC3B,IAAI,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;YAC/B,2BAA2B;YAC3B,OAAO,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;SAC3C;QACD,uBAAuB;QACvB,OAAO,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;IACpD,CAAC;IAED;;OAEG;IACI,eAAe,CAAC,CAAa;QAClC,OAAO,IAAI,CAAC;IACd,CAAC;IAED;;OAEG;IACI,UAAU,CAAC,CAAQ;QACxB,OAAO;IACT,CAAC;IAED;;OAEG;IACI,YAAY;QACjB,OAAO,IAAI,CAAC,SAAS,CAAC;IACxB,CAAC;CACF","sourcesContent":["import { Scope } from '@sentry/hub';\nimport { Breadcrumb, SentryEvent, SentryEventHint, SentryResponse, Severity, Transport } from '@sentry/types';\nimport { logger } from '@sentry/utils/logger';\nimport { serialize } from '@sentry/utils/object';\nimport { SentryError } from './error';\nimport { Backend, Options } from './interfaces';\nimport { NoopTransport } from './transports/noop';\n\n/** A class object that can instanciate Backend objects. */\nexport interface BackendClass<B extends Backend, O extends Options> {\n  new (options: O): B;\n}\n\n/**\n * This is the base implemention of a Backend.\n */\nexport abstract class BaseBackend<O extends Options> implements Backend {\n  /** Options passed to the SDK. */\n  protected readonly options: O;\n\n  /** Cached transport used internally. */\n  protected transport: Transport;\n\n  /** Creates a new browser backend instance. */\n  public constructor(options: O) {\n    this.options = options;\n    if (!this.options.dsn) {\n      logger.warn('No DSN provided, backend will not do anything.');\n    }\n    this.transport = this.setupTransport();\n  }\n\n  /**\n   * Sets up the transport so it can be used later to send requests.\n   */\n  protected setupTransport(): Transport {\n    return new NoopTransport();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public async eventFromException(_exception: any, _hint?: SentryEventHint): Promise<SentryEvent> {\n    throw new SentryError('Backend has to implement `eventFromException` method');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public async eventFromMessage(_message: string, _level?: Severity, _hint?: SentryEventHint): Promise<SentryEvent> {\n    throw new SentryError('Backend has to implement `eventFromMessage` method');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public async sendEvent(event: SentryEvent): Promise<SentryResponse> {\n    // TODO: Remove with v5\n    // tslint:disable-next-line\n    if (this.transport.captureEvent) {\n      // tslint:disable-next-line\n      return this.transport.captureEvent(event);\n    }\n    // --------------------\n    return this.transport.sendEvent(serialize(event));\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public storeBreadcrumb(_: Breadcrumb): boolean {\n    return true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public storeScope(_: Scope): void {\n    // Noop\n  }\n\n  /**\n   * @inheritDoc\n   */\n  public getTransport(): Transport {\n    return this.transport;\n  }\n}\n"]}