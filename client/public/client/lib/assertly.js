!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function l(e){try{u(o.next(e))}catch(e){i(e)}}function c(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,c)}u((o=o.apply(e,n||[])).next())}))},i=this&&this.__generator||function(e,n){var t,o,r,i,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(r=l.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){l.label=i[1];break}if(6===i[0]&&l.label<r[1]){l.label=r[1],r=i;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(i);break}r[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=t(1),u=l(t(2)),a=function(){var e=this;this.eventsToRecord=["click","change"],this.componentEventCache=[],this.previousComponent=null,this.previousMsg=null,this.start=function(){e.eventRecorder.start()},this.stop=function(){e.eventRecorder.stop()},this.clearEventCache=function(){e.componentEventCache=[]},this.reconcileEventCache=function(n){(n.target?c.findReactElement(n.target):null)!==e.previousComponent&&(e.componentEventCache.forEach((function(n){console.log("in the reconcile"),e.sendEvent(n)})),e.clearEventCache())},this.removeMenusByClassname=function(e){var n=Array.from(document.getElementsByClassName(e));null==n||n.map((function(e){return e.remove()}))},this.setupMenuDiv=function(e){var n="componentMenu"+(new Date).getTime(),t=document.createElement("DIV");return t.setAttribute("id",n),t.setAttribute("class","componentMenu"),document.body.appendChild(t),t.style.position="absolute",t.style.left=e.x+"px",t.style.top=e.y+"px",t.style.zIndex="9999999999999",n},this.appendCancelButton=function(n){var t,o=document.createElement("BUTTON");o.style.width="150px",o.innerHTML="Cancel",o.addEventListener("click",(function(){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.removeSingleMenu(n)];case 1:return[2,e.sent()]}}))}))})),null===(t=document.getElementById(n))||void 0===t||t.appendChild(o)},this.createPopupMenu=function(n,t){var o;e.removeMenusByClassname("componentMenu");var l=e.setupMenuDiv(t);null===(o=null==n?void 0:n.componentInfo)||void 0===o||o.map((function(t){var o,c;console.log("button val: ",t);var u=document.createElement("BUTTON");if(u.style.width="150px",u.innerHTML=null==t?void 0:t.componentName,u.innerHTML){u.addEventListener("click",(function(t){return r(e,void 0,void 0,(function(){return i(this,(function(e){return[2,this.componentMenuClick(t,l,n)]}))}))})),null===(o=document.getElementById(l))||void 0===o||o.appendChild(u);var a=document.createElement("br");null===(c=document.getElementById(l))||void 0===c||c.appendChild(a)}})),e.appendCancelButton(l)},this.createExistingTestMenu=function(n,t){return r(e,void 0,void 0,(function(){var e;return i(this,(function(t){return e=this.setupMenuDiv(n),["a","b"].map((function(n){var t,o,r=document.createElement("BUTTON");r.style.width="150px",r.innerHTML=n,null===(t=document.getElementById(e))||void 0===t||t.appendChild(r);var i=document.createElement("br");null===(o=document.getElementById(e))||void 0===o||o.appendChild(i)})),this.appendCancelButton(e),[2]}))}))},this.removeSingleMenu=function(n){return r(e,void 0,void 0,(function(){var e;return i(this,(function(t){return null==(e=document.getElementById(n))||e.remove(),[2]}))}))},this.componentMenuClick=function(n,t,l){return r(e,void 0,void 0,(function(){var e,r,c;return i(this,(function(i){switch(i.label){case 0:return[4,this.removeSingleMenu(t)];case 1:return i.sent(),e=null===(c=l.componentInfo)||void 0===c?void 0:c.reduce((function(e,t){var r;return t.componentName===(null===(r=n.target)||void 0===r?void 0:r.innerHTML)?o({},t):e}),null),null==n||n.stopPropagation(),[4,this.checkForExistingTest(null==e?void 0:e.filename)];case 2:return r=i.sent(),[4,this.createExistingTestMenu(n,r)];case 3:return i.sent(),[2]}}))}))},this.getMessage=function(e,n){var t,r,i,l=n.target||n.srcElement,u=l,a=l,s=c.getComponentInfo(e,10,[]),d=null===(r=null===(t=null==s?void 0:s.slice(0))||void 0===t?void 0:t.reverse())||void 0===r?void 0:r.reduce((function(e,n){var t;return(null===(t=n.props)||void 0===t?void 0:t.onClick)?o({},n):e}),null);return{action:n.type,checked:(null===(i=null==n?void 0:n.target)||void 0===i?void 0:i.hasOwnProperty("checked"))?u.checked:null,coordinates:c.getCoordinates(n),href:a.href?a.href:null,keyCode:n.keyCode?n.keyCode:null,tagName:u.tagName,tagType:u.type,textContent:u.textContent||u.innerText,timestamp:(new Date).getTime(),value:u.value,writeTestLocation:"",componentInfo:s,clickHandlerComponent:d}},this.recordEvent=function(n){var t,o,r=n.target,i=n;if(!(null===(o=null===(t=null==r?void 0:r.parentElement)||void 0===t?void 0:t.getAttribute("id"))||void 0===o?void 0:o.includes("componentMenu"))&&n.target)try{if(e.previousMsg&&("change"===n.type||"click"===n.type)&&e.previousMsg&&"click"===e.previousMsg.action&&(new Date).getTime()-e.previousMsg.timestamp<100)return void console.log("message not send due to time");var l=c.findReactElement(n.target),u=e.getMessage(l,n);console.log("reactComponent and message in RECORD_EVENT: ",l,u),localStorage.setItem("lastEvent",JSON.stringify(u)),e.previousMsg=u,e.previousComponent=l,(null==i?void 0:i.metaKey)&&e.createPopupMenu(u,i)}catch(e){console.error("Error recording event",e)}},this.sendEvent=function(n){return r(e,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return(e=window.dataLayer[0].apiKey)||(e=1),[4,fetch("//localhost:3020/api/accounts/"+e+"/events/",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:window.location.href,event:n,placeholder:null})})];case 1:return[2,t.sent().json()]}}))}))},this.checkForExistingTest=function(n){return r(e,void 0,void 0,(function(){var e,t,o;return i(this,(function(r){switch(r.label){case 0:return(e=window.dataLayer[0].apiKey)||(e=1),t=encodeURI(n),o="//localhost:3020/api/accounts/"+e+"/events/?filepath="+t,console.log("url hit: ",o,t),[4,fetch(o,{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"}})];case 1:return[2,r.sent().json()]}}))}))},this.eventRecorder=new u.default({recordEvents:this.eventsToRecord,eventCallback:this.recordEvent,reconcileCallback:this.reconcileEventCache})};n.default=a,window.eventRecorder=new a,window.eventRecorder.start()},function(e,n,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function r(e,n){var t;if(void 0===n&&(n={}),!e)return c(n),n;var i=e.pendingProps?o(o({},n),e.pendingProps):n;return delete i.children,(null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.__proto__)&&["Component","PureComponent"].includes(e.type.__proto__.name)?(c(i),i):r(e._debugOwner,i)}function i(e){return e?e.elementType&&e.elementType.name?e.elementType.name:e.elementType&&e.elementType.displayName?e.elementType.displayName:e.type.displayName?e.type.displayName:e.type.name?e.type.name:i(e._debugOwner):null}Object.defineProperty(n,"__esModule",{value:!0}),n.functionStringify=n.findReactElement=n.findReactElementDURKA=n.getCoordinates=n.getComponentName=n.getComponentProps=n.getComponentInfo=void 0,n.getComponentInfo=function e(n,t,o){var l,c,u,a,s;if(console.log("getComponentInfo: ",n,o),!n||0===t)return o;if(null===(l=null==n?void 0:n._debugSource)||void 0===l?void 0:l.fileName){var d=r(null==n?void 0:n._debugOwner),v=i(null==n?void 0:n._debugOwner);return o.push({filename:null===(c=null==n?void 0:n._debugSource)||void 0===c?void 0:c.fileName,linenumber:null===(u=null==n?void 0:n._debugSource)||void 0===u?void 0:u.lineNumber,props:d,componentName:"Component"===v?null===(s=null===(a=null==n?void 0:n._debugSource)||void 0===a?void 0:a.fileName)||void 0===s?void 0:s.split("\\").pop().split("/").pop().split(".")[0]:v}),e(null==n?void 0:n._debugOwner,t-1,o)}return e(null==n?void 0:n._debugOwner,t-1,o)},n.getComponentProps=r,n.getComponentName=i;var l={mouseup:!0,mousedown:!0,mousemove:!0,mouseover:!0};function c(e){for(var n in e)if(e[n]&&"[object Function]"==={}.toString.call(e[n]))try{e[n]="[Function]"}catch(e){console.error("Error stringifying prop",e)}!function(e){for(var n=Object.keys(e),t=0,o=n;t<o.length;t++){var r=o[t];"[object Object]"!==Object.prototype.toString.call(e[r])||!e[r].hasOwnProperty("_owner")&&"inputRef"!==r&&"InputProps"!==r||delete e[r]}}(e)}n.getCoordinates=function(e){var n=e;return l[e.type]?{x:n.clientX,y:n.clientY}:null},n.findReactElementDURKA=function(e){var n=Object.keys(e).find((function(e){return e.startsWith("__reactInternalInstance$")})),t=n?e[n]:null;return null==t?null:t},n.findReactElement=function(e){var n=e;for(var t in n)if(t.startsWith("__reactInternalInstance$"))return n[t];return null},n.functionStringify=c},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){var n=this;this.recordEvents=[],this.reconcileEvents=["blur","focus","change"],this.addAllListeners=function(){n.recordEvents.forEach((function(e){window.addEventListener(e,n.eventCallback,!0)})),n.reconcileEvents.forEach((function(e){window.addEventListener(e,n.reconcileCallback,!0)}))},this.removeAllListeners=function(){n.recordEvents.forEach((function(e){window.removeEventListener(e,n.eventCallback,!0)})),n.reconcileEvents.forEach((function(e){window.removeEventListener(e,n.reconcileCallback,!0)}))},this.start=function(){window.recorderAddedControlListeners||(n.addAllListeners(),window.recorderAddedControlListeners=!0)},this.stop=function(){window.recorderAddedControlListeners&&(n.removeAllListeners(),window.recorderAddedControlListeners=!1)};var t=e.eventCallback,o=e.reconcileCallback,r=e.recordEvents,i=e.reconcileEvents,l=void 0===i?null:i;this.eventCallback=t,this.reconcileCallback=o,this.recordEvents=r,l&&(this.reconcileEvents=l)};n.default=o}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NsaWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V2ZW50LXJlY29yZGVyLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiZXZlbnRzVG9SZWNvcmQiLCJjb21wb25lbnRFdmVudENhY2hlIiwicHJldmlvdXNDb21wb25lbnQiLCJwcmV2aW91c01zZyIsInN0YXJ0IiwiZXZlbnRSZWNvcmRlciIsInN0b3AiLCJjbGVhckV2ZW50Q2FjaGUiLCJyZWNvbmNpbGVFdmVudENhY2hlIiwiZXZlbnQiLCJ0YXJnZXQiLCJmaW5kUmVhY3RFbGVtZW50IiwiZm9yRWFjaCIsIm1zZyIsImNvbnNvbGUiLCJsb2ciLCJzZW5kRXZlbnQiLCJyZW1vdmVNZW51c0J5Q2xhc3NuYW1lIiwiY2xhc3NuYW1lIiwicHJldmlvdXNNZW51cyIsIkFycmF5IiwiZnJvbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsIm1hcCIsInZhbCIsInJlbW92ZSIsInNldHVwTWVudURpdiIsIm1vdXNlRXZlbnQiLCJkaXZJRCIsIkRhdGUiLCJnZXRUaW1lIiwibWVudURpdiIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJzdHlsZSIsInBvc2l0aW9uIiwibGVmdCIsIngiLCJ0b3AiLCJ5IiwiekluZGV4IiwiYXBwZW5kQ2FuY2VsQnV0dG9uIiwiQ2FuY2VsQnRuIiwid2lkdGgiLCJpbm5lckhUTUwiLCJhZGRFdmVudExpc3RlbmVyIiwidGhpcyIsInJlbW92ZVNpbmdsZU1lbnUiLCJnZXRFbGVtZW50QnlJZCIsImNyZWF0ZVBvcHVwTWVudSIsIm1lc3NhZ2UiLCJjb21wb25lbnRJbmZvIiwiYnRuIiwiY29tcG9uZW50TmFtZSIsImNvbXBvbmVudE1lbnVDbGljayIsImJyIiwiY3JlYXRlRXhpc3RpbmdUZXN0TWVudSIsImV4aXN0aW5nVGVzdFJlc3BvbnNlIiwiZXhpc3RpbmdUZXN0RGl2SUQiLCJzZWxlY3RlZENvbXBvbmVudCIsInJlZHVjZSIsImFjYyIsImN1cnIiLCJzdG9wUHJvcGFnYXRpb24iLCJjaGVja0ZvckV4aXN0aW5nVGVzdCIsImZpbGVuYW1lIiwiZ2V0TWVzc2FnZSIsInJlYWN0Q29tcG9uZW50Iiwic3JjRWxlbWVudCIsImlucHV0VGFyZ2V0IiwibGlua1RhcmdldCIsImdldENvbXBvbmVudEluZm8iLCJjbGlja0hhbmRsZXIiLCJzbGljZSIsInJldmVyc2UiLCJhY2N1bXVsYXRvciIsImN1cnJlbnRWYWx1ZSIsInByb3BzIiwib25DbGljayIsImFjdGlvbiIsInR5cGUiLCJjaGVja2VkIiwiY29vcmRpbmF0ZXMiLCJnZXRDb29yZGluYXRlcyIsImhyZWYiLCJrZXlDb2RlIiwidGFnTmFtZSIsInRhZ1R5cGUiLCJ0ZXh0Q29udGVudCIsImlubmVyVGV4dCIsInRpbWVzdGFtcCIsIndyaXRlVGVzdExvY2F0aW9uIiwiY2xpY2tIYW5kbGVyQ29tcG9uZW50IiwicmVjb3JkRXZlbnQiLCJub2RlVGFyZ2V0IiwicGFyZW50RWxlbWVudCIsImdldEF0dHJpYnV0ZSIsImluY2x1ZGVzIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtZXRhS2V5IiwiZSIsImVycm9yIiwiYWNjb3VudElkIiwid2luZG93IiwiZmV0Y2giLCJtZXRob2QiLCJjYWNoZSIsImNyZWRlbnRpYWxzIiwiaGVhZGVycyIsInVybCIsImxvY2F0aW9uIiwicGxhY2Vob2xkZXIiLCJqc29uIiwiZmlsZXBhdGgiLCJ1cmlGaWxlcGF0aCIsImVuY29kZVVSSSIsInJlY29yZEV2ZW50cyIsImV2ZW50Q2FsbGJhY2siLCJyZWNvbmNpbGVDYWxsYmFjayIsIkFzc2VydGx5Q2xpZW50IiwiZ2V0Q29tcG9uZW50UHJvcHMiLCJjb21wb25lbnQiLCJmdW5jdGlvblN0cmluZ2lmeSIsIm5ld1Byb3BzIiwicGVuZGluZ1Byb3BzIiwiY2hpbGRyZW4iLCJfX3Byb3RvX18iLCJfZGVidWdPd25lciIsImdldENvbXBvbmVudE5hbWUiLCJmaWJlciIsImVsZW1lbnRUeXBlIiwiZGlzcGxheU5hbWUiLCJtYXhOZXN0IiwicmVzdWx0QXJyYXkiLCJfZGVidWdTb3VyY2UiLCJmaWxlTmFtZSIsInB1c2giLCJsaW5lbnVtYmVyIiwibGluZU51bWJlciIsInNwbGl0IiwicG9wIiwiZXZlbnRzV2l0aENvb3JkaW5hdGVzIiwibW91c2V1cCIsIm1vdXNlZG93biIsIm1vdXNlbW92ZSIsIm1vdXNlb3ZlciIsIm9iaiIsImsiLCJ0b1N0cmluZyIsImtleXMiLCJzdHJpcEV4dHJhQ29tcG9uZW50UHJvcHMiLCJjbGllbnRYIiwiY2xpZW50WSIsImZpbmQiLCJzdGFydHNXaXRoIiwiaW50ZXJuYWxJbnN0YW5jZSIsInRhcmdldE1hcCIsImNvbmZpZyIsInJlY29uY2lsZUV2ZW50cyIsImFkZEFsbExpc3RlbmVycyIsInJlbW92ZUFsbExpc3RlbmVycyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZWNvcmRlckFkZGVkQ29udHJvbExpc3RlbmVycyJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVB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QUFNLGtCQUZSekMsRUFFRXlDLEVBQU0sYUFEUixFQUNFQSxFQUFNLGdCQURSQyxPQUFlLElBQUcsT0FBSSxFQUV4Qm5ILEtBQUswRSxjQUFnQkEsRUFDckIxRSxLQUFLMkUsa0JBQW9CQSxFQUN6QjNFLEtBQUt5RSxhQUFlQSxFQUNoQjBDLElBQ0ZuSCxLQUFLbUgsZ0JBQWtCQSxJIiwiZmlsZSI6ImFzc2VydGx5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0IHtcbiAgZmluZFJlYWN0RWxlbWVudCxcbiAgZ2V0Q29vcmRpbmF0ZXMsXG4gIGdldENvbXBvbmVudE5hbWUsXG4gIGdldENvbXBvbmVudFByb3BzLFxuICBnZXRDb21wb25lbnRJbmZvXG59IGZyb20gXCIuL3V0aWxzXCI7XG5cblxuaW1wb3J0IEV2ZW50UmVjb3JkZXIgZnJvbSBcIi4vZXZlbnQtcmVjb3JkZXJcIjtcbmltcG9ydCBDbGllbnRJbnRlcmZhY2UgZnJvbSBcIi4vdHlwZXMvQ2xpZW50XCI7XG5pbXBvcnQgTWVzc2FnZSBmcm9tIFwiLi90eXBlcy9NZXNzYWdlXCI7XG5pbXBvcnQgeyBFdmVudFR5cGUgfSBmcm9tIFwiLi90eXBlcy9FdmVudFR5cGVcIjtcblxuaW50ZXJmYWNlIENvbXBvbmVudCB7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFzc2VydGx5Q2xpZW50IGltcGxlbWVudHMgQ2xpZW50SW50ZXJmYWNlIHtcbiAgZXZlbnRzVG9SZWNvcmQ6IEV2ZW50VHlwZVtdID0gW1wiY2xpY2tcIiwgXCJjaGFuZ2VcIl07XG5cbiAgcHJpdmF0ZSBldmVudFJlY29yZGVyOiBFdmVudFJlY29yZGVyO1xuICBwcml2YXRlIGNvbXBvbmVudEV2ZW50Q2FjaGU6IE1lc3NhZ2VbXSA9IFtdO1xuICBwcml2YXRlIHByZXZpb3VzQ29tcG9uZW50OiBDb21wb25lbnQgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBwcmV2aW91c01zZzogTWVzc2FnZSB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZXZlbnRSZWNvcmRlciA9IG5ldyBFdmVudFJlY29yZGVyKHtcbiAgICAgIHJlY29yZEV2ZW50czogdGhpcy5ldmVudHNUb1JlY29yZCxcbiAgICAgIGV2ZW50Q2FsbGJhY2s6IHRoaXMucmVjb3JkRXZlbnQsXG4gICAgICByZWNvbmNpbGVDYWxsYmFjazogdGhpcy5yZWNvbmNpbGVFdmVudENhY2hlLFxuICAgIH0pO1xuICB9XG5cbiAgc3RhcnQgPSAoKSA9PiB7XG4gICAgdGhpcy5ldmVudFJlY29yZGVyLnN0YXJ0KCk7XG4gIH07XG5cbiAgc3RvcCA9ICgpID0+IHtcbiAgICB0aGlzLmV2ZW50UmVjb3JkZXIuc3RvcCgpO1xuICB9O1xuXG4gIGNsZWFyRXZlbnRDYWNoZSA9ICgpID0+IHtcbiAgICB0aGlzLmNvbXBvbmVudEV2ZW50Q2FjaGUgPSBbXTtcbiAgfTtcblxuICByZWNvbmNpbGVFdmVudENhY2hlID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuICAgIGNvbnN0IHJlYWN0Q29tcG9uZW50ID0gZXZlbnQudGFyZ2V0ID8gZmluZFJlYWN0RWxlbWVudChldmVudC50YXJnZXQpIDogbnVsbDtcbiAgICBpZiAocmVhY3RDb21wb25lbnQgIT09IHRoaXMucHJldmlvdXNDb21wb25lbnQpIHtcbiAgICAgIHRoaXMuY29tcG9uZW50RXZlbnRDYWNoZS5mb3JFYWNoKChtc2cpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2luIHRoZSByZWNvbmNpbGUnKTtcbiAgICAgICAgdGhpcy5zZW5kRXZlbnQobXNnKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jbGVhckV2ZW50Q2FjaGUoKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gcmVtb3ZlIGFsbCBkaXZzIHdpdGggYSBjZXJ0YWluIGNsYXNzbmFtZVxuICByZW1vdmVNZW51c0J5Q2xhc3NuYW1lID0gKGNsYXNzbmFtZTogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgcHJldmlvdXNNZW51cyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc25hbWUpKTtcbiAgICBwcmV2aW91c01lbnVzPy5tYXAoKHZhbDogYW55KSA9PiB2YWwucmVtb3ZlKCkpO1xuICB9XG5cbiAgc2V0dXBNZW51RGl2ID0gKG1vdXNlRXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICBjb25zdCBldmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICBjb25zdCBkaXZJRCA9IFwiY29tcG9uZW50TWVudVwiICsgZXZlbnRUaW1lO1xuICAgIGNvbnN0IG1lbnVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiRElWXCIpO1xuXG4gICAgbWVudURpdi5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBkaXZJRCk7XG4gICAgbWVudURpdi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCAnY29tcG9uZW50TWVudScpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobWVudURpdik7XG4gICAgbWVudURpdi5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcbiAgICBtZW51RGl2LnN0eWxlLmxlZnQgPSBtb3VzZUV2ZW50LnggKyAncHgnO1xuICAgIG1lbnVEaXYuc3R5bGUudG9wID0gbW91c2VFdmVudC55ICsgJ3B4JztcbiAgICBtZW51RGl2LnN0eWxlLnpJbmRleCA9ICc5OTk5OTk5OTk5OTk5JztcbiAgICByZXR1cm4gZGl2SURcbiAgfVxuXG4gIGFwcGVuZENhbmNlbEJ1dHRvbiA9IChjbGFzc25hbWU6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IENhbmNlbEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJCVVRUT05cIik7XG4gICAgQ2FuY2VsQnRuLnN0eWxlLndpZHRoID0gJzE1MHB4JztcbiAgICBDYW5jZWxCdG4uaW5uZXJIVE1MID0gJ0NhbmNlbCc7XG4gICAgQ2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5yZW1vdmVTaW5nbGVNZW51KGNsYXNzbmFtZSkpO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNsYXNzbmFtZSk/LmFwcGVuZENoaWxkKENhbmNlbEJ0bik7XG4gIH1cblxuICBjcmVhdGVQb3B1cE1lbnUgPSAobWVzc2FnZTogTWVzc2FnZSwgbW91c2VFdmVudDogTW91c2VFdmVudCkgPT4ge1xuXG4gICAgLy8gcmVtb3ZlIGFsbCBleGlzdGluZyBtZW51c1xuICAgIHRoaXMucmVtb3ZlTWVudXNCeUNsYXNzbmFtZSgnY29tcG9uZW50TWVudScpXG4gICAgLy8gY3JlYXRlIHRoZSBkb20gZWxlbWVudCBhbmQgc3RvcmUgdGhlIGVsZW1lbnQgSURcbiAgICBjb25zdCBkaXZJRCA9IHRoaXMuc2V0dXBNZW51RGl2KG1vdXNlRXZlbnQpICAgIFxuXG4gICAgbWVzc2FnZT8uY29tcG9uZW50SW5mbz8ubWFwKCh2YWw6IGFueSkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJidXR0b24gdmFsOiBcIiwgdmFsKTtcbiAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJCVVRUT05cIik7XG4gICAgICBidG4uc3R5bGUud2lkdGggPSAnMTUwcHgnO1xuICAgICAgYnRuLmlubmVySFRNTCA9IHZhbD8uY29tcG9uZW50TmFtZTtcbiAgICAgIGlmIChidG4uaW5uZXJIVE1MKSB7XG4gICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChldmVudCkgPT4gdGhpcy5jb21wb25lbnRNZW51Q2xpY2soZXZlbnQsIGRpdklELCBtZXNzYWdlKSk7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRpdklEKT8uYXBwZW5kQ2hpbGQoYnRuKTtcbiAgICAgICAgY29uc3QgYnIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIik7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRpdklEKT8uYXBwZW5kQ2hpbGQoYnIpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuYXBwZW5kQ2FuY2VsQnV0dG9uKGRpdklEKVxuXG4gIH07XG5cbiAgY3JlYXRlRXhpc3RpbmdUZXN0TWVudSA9IGFzeW5jIChldmVudDogYW55LCBleGlzdGluZ1Rlc3RSZXNwb25zZTogYW55KSA9PiB7XG4gICBcbiAgICBjb25zdCBleGlzdGluZ1Rlc3REaXZJRCA9IHRoaXMuc2V0dXBNZW51RGl2KGV2ZW50KSAgXG4gICAgY29uc3QgdGVzdCA9IFtcImFcIixcImJcIl1cblxuICAgIHRlc3QubWFwKCB2YWwgPT4ge1xuICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIkJVVFRPTlwiKTtcbiAgICAgIGJ0bi5zdHlsZS53aWR0aCA9ICcxNTBweCc7XG4gICAgICBidG4uaW5uZXJIVE1MID0gdmFsO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZXhpc3RpbmdUZXN0RGl2SUQpPy5hcHBlbmRDaGlsZChidG4pO1xuICAgICAgY29uc3QgYnIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIik7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChleGlzdGluZ1Rlc3REaXZJRCk/LmFwcGVuZENoaWxkKGJyKTtcbiAgICB9KVxuICAgIHRoaXMuYXBwZW5kQ2FuY2VsQnV0dG9uKGV4aXN0aW5nVGVzdERpdklEKVxuICB9XG5cbiAgcmVtb3ZlU2luZ2xlTWVudSA9IGFzeW5jIChkaXZJRDogYW55KSA9PiB7XG4gICAgY29uc3QgbWVudURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRpdklEKTtcbiAgICBtZW51RGl2Py5yZW1vdmUoKTtcbiAgfTtcblxuICBjb21wb25lbnRNZW51Q2xpY2sgPSBhc3luYyAoZXZlbnQ6IGFueSwgZGl2SUQ6IGFueSwgbWVzc2FnZTogTWVzc2FnZSk6IFByb21pc2U8YW55PiA9PiB7XG5cbiAgICBhd2FpdCB0aGlzLnJlbW92ZVNpbmdsZU1lbnUoZGl2SUQpO1xuXG4gICAgY29uc3Qgc2VsZWN0ZWRDb21wb25lbnQgPSBtZXNzYWdlLmNvbXBvbmVudEluZm8/LnJlZHVjZShcbiAgICAgIChhY2M6IGFueSwgY3VycjogYW55KSA9PiB7XG4gICAgICAgIGlmIChjdXJyLmNvbXBvbmVudE5hbWUgPT09IGV2ZW50LnRhcmdldD8uaW5uZXJIVE1MKSB7XG4gICAgICAgICAgcmV0dXJuIHsuLi5jdXJyfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9XG4gICAgICB9LCBudWxsKTtcblxuICAgIGV2ZW50Py5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBcbiAgICBjb25zdCBleGlzdGluZ1Rlc3RSZXNwb25zZSA9IGF3YWl0IHRoaXMuY2hlY2tGb3JFeGlzdGluZ1Rlc3Qoc2VsZWN0ZWRDb21wb25lbnQ/LmZpbGVuYW1lKTtcbiAgICBcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuY3JlYXRlRXhpc3RpbmdUZXN0TWVudShldmVudCwgZXhpc3RpbmdUZXN0UmVzcG9uc2UpXG5cbiAgICAvLyB0aGlzLnNlbmRFdmVudCh7XG4gICAgLy8gICAuLi5tZXNzYWdlLFxuICAgIC8vICAgLy8gdGhlcmUgc2hvdWxkIG9ubHkgYmUgb25lIG1hdGNoIGhlcmUgb24gdGhlIGZpbHRlclxuICAgIC8vICAgLy8gY29tcG9uZW50SW5mbzogbWVzc2FnZS5jb21wb25lbnRJbmZvPy5maWx0ZXIoICh2YWw6YW55KSA9PiB2YWwuY29tcG9uZW50TmFtZSA9PT0gZXZlbnQudGFyZ2V0Py5pbm5lckhUTUwpXG4gICAgLy8gICBjb21wb25lbnRJbmZvOiBzZWxlY3RlZENvbXBvbmVudFxuICAgIC8vIH0pLnRoZW4ocmVzID0+IHtjb25zb2xlLmxvZygnZG90IHRoZW4nLCByZXMpfSk7XG5cblxuICB9O1xuXG5cblxuICBnZXRNZXNzYWdlID0gKHJlYWN0Q29tcG9uZW50OiBhbnksIGV2ZW50OiBLZXlib2FyZEV2ZW50IHwgRXZlbnQpOiBNZXNzYWdlID0+IHtcblxuICAgIC8vIGZ1bmN0aW9uIHRvIHVzZSBpbiBhcnJheSByZWR1Y2VcbiAgICBjb25zdCBmaW5kQ2xpY2tIYW5kbGVyID0gKGFjY3VtdWxhdG9yOiBhbnksIGN1cnJlbnRWYWx1ZTogYW55KSA9PiB7XG4gICAgICBpZiAoY3VycmVudFZhbHVlLnByb3BzPy5vbkNsaWNrKSB7XG4gICAgICAgIHJldHVybiB7Li4uY3VycmVudFZhbHVlfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQ7XG4gICAgY29uc3QgaW5wdXRUYXJnZXQgPSB0YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICBjb25zdCBsaW5rVGFyZ2V0ID0gdGFyZ2V0IGFzIEhUTUxMaW5rRWxlbWVudDtcblxuICAgIGNvbnN0IGNvbXBvbmVudEluZm8gPSBnZXRDb21wb25lbnRJbmZvKHJlYWN0Q29tcG9uZW50LCAxMCwgW10pO1xuXG4gICAgLy8gZmluZCB0aGUgY2xvc2VzdCBjbGljayBoYW5kbGVyIHRoYXQgd291bGQgaGF2ZSBiZWVuIHRyaWdnZXJlZFxuICAgIC8vIG5vdGUsIHNsaWNlKDApIGNvcGllcyB0aGUgYXJyYXlcbiAgICBjb25zdCBjbGlja0hhbmRsZXIgPSBjb21wb25lbnRJbmZvPy5zbGljZSgwKT8ucmV2ZXJzZSgpPy5yZWR1Y2UoZmluZENsaWNrSGFuZGxlciwgbnVsbCk7XG5cblxuICAgIC8vIGNvbnNvbGUubG9nKCdjb21wb25lbnQgaW5mbyBpbiBHRVRfTUVTU0FHRTogJywgY29tcG9uZW50SW5mbywgY2xpY2tIYW5kbGVyKVxuXG4gICAgY29uc3QgbWVzc2FnZTogTWVzc2FnZSA9IHtcbiAgICAgIC8vIGNvbXBvbmVudE5hbWUsIGZpbGVOYW1lLCBhbmQgbGluZU51bWJlciBhcmUgYWxyZWFkeSBpbiB0aGUgb2JqZWN0IHJldHVybmVkXG4gICAgICBhY3Rpb246IGV2ZW50LnR5cGUsXG4gICAgICBjaGVja2VkOiBldmVudD8udGFyZ2V0Py5oYXNPd25Qcm9wZXJ0eShcImNoZWNrZWRcIilcbiAgICAgICAgPyBpbnB1dFRhcmdldC5jaGVja2VkXG4gICAgICAgIDogbnVsbCxcbiAgICAgIGNvb3JkaW5hdGVzOiBnZXRDb29yZGluYXRlcyhldmVudCksXG4gICAgICBocmVmOiBsaW5rVGFyZ2V0LmhyZWYgPyBsaW5rVGFyZ2V0LmhyZWYgOiBudWxsLFxuICAgICAga2V5Q29kZTogKGV2ZW50IGFzIEtleWJvYXJkRXZlbnQpLmtleUNvZGVcbiAgICAgICAgPyAoZXZlbnQgYXMgS2V5Ym9hcmRFdmVudCkua2V5Q29kZVxuICAgICAgICA6IG51bGwsXG4gICAgICB0YWdOYW1lOiBpbnB1dFRhcmdldC50YWdOYW1lLFxuICAgICAgdGFnVHlwZTogaW5wdXRUYXJnZXQudHlwZSxcbiAgICAgIHRleHRDb250ZW50OiBpbnB1dFRhcmdldC50ZXh0Q29udGVudCB8fCBpbnB1dFRhcmdldC5pbm5lclRleHQsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxuICAgICAgdmFsdWU6IGlucHV0VGFyZ2V0LnZhbHVlLFxuICAgICAgd3JpdGVUZXN0TG9jYXRpb246ICcnLFxuICAgICAgY29tcG9uZW50SW5mbzogY29tcG9uZW50SW5mbyxcbiAgICAgIGNsaWNrSGFuZGxlckNvbXBvbmVudDogY2xpY2tIYW5kbGVyXG5cbiAgICB9O1xuXG4gICAgcmV0dXJuIG1lc3NhZ2U7XG4gIH07XG5cblxuICByZWNvcmRFdmVudCA9IChldmVudDogRXZlbnQpID0+IHtcbiAgICBjb25zdCBub2RlVGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIE5vZGU7XG4gICAgY29uc3QgbW91c2VFdmVudCA9IGV2ZW50IGFzIE1vdXNlRXZlbnQ7XG5cbiAgICAvLyBpZiB0aGUgY2xpY2sgaXMgb24gYSBtZW51IHRoYXQgcG9wcyB1cCwgZG9udCBnbyB0aHJvdWdoIHRoZSByZWNvcmQgZXZlbnQgbG9naWNcbiAgICBpZiAobm9kZVRhcmdldD8ucGFyZW50RWxlbWVudD8uZ2V0QXR0cmlidXRlKFwiaWRcIik/LmluY2x1ZGVzKCdjb21wb25lbnRNZW51JykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFldmVudC50YXJnZXQpIHJldHVybjtcblxuICAgIHRyeSB7XG4gICAgICBpZiAodGhpcy5wcmV2aW91c01zZykge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgKGV2ZW50LnR5cGUgPT09IFwiY2hhbmdlXCIgfHwgZXZlbnQudHlwZSA9PT0gXCJjbGlja1wiKSAmJlxuICAgICAgICAgIHRoaXMucHJldmlvdXNNc2cgJiZcbiAgICAgICAgICB0aGlzLnByZXZpb3VzTXNnLmFjdGlvbiA9PT0gXCJjbGlja1wiICYmXG4gICAgICAgICAgbmV3IERhdGUoKS5nZXRUaW1lKCkgLSB0aGlzLnByZXZpb3VzTXNnLnRpbWVzdGFtcCA8IDEwMFxuICAgICAgICApIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIm1lc3NhZ2Ugbm90IHNlbmQgZHVlIHRvIHRpbWVcIik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlYWN0Q29tcG9uZW50ID0gZmluZFJlYWN0RWxlbWVudChldmVudC50YXJnZXQpO1xuICAgICAgY29uc3QgbXNnOiBNZXNzYWdlID0gdGhpcy5nZXRNZXNzYWdlKHJlYWN0Q29tcG9uZW50LCBldmVudCk7XG4gICAgICBjb25zb2xlLmxvZygncmVhY3RDb21wb25lbnQgYW5kIG1lc3NhZ2UgaW4gUkVDT1JEX0VWRU5UOiAnLCByZWFjdENvbXBvbmVudCwgbXNnKTtcblxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJsYXN0RXZlbnRcIiwgSlNPTi5zdHJpbmdpZnkobXNnKSk7XG4gICAgICB0aGlzLnByZXZpb3VzTXNnID0gbXNnO1xuXG4gICAgICAvLyBpZiAoXG4gICAgICAvLyAgIC8vIGlmIHRoZXJlIGlzIG5vIHByZXZpb3VzIGNvbXBvbmVudCBvciB0aGUgcHJldmlvdXMgY29tcG9uZW50IGlzIHRoZSBzYW1lIGFzIHRoZSBjb21wb25lbnQgeW91IGp1c3QgY2xpY2tlZCBvblxuICAgICAgLy8gICAhdGhpcy5wcmV2aW91c0NvbXBvbmVudCB8fFxuICAgICAgLy8gICAodGhpcy5wcmV2aW91c0NvbXBvbmVudCAmJiB0aGlzLnByZXZpb3VzQ29tcG9uZW50ID09PSByZWFjdENvbXBvbmVudClcbiAgICAgIC8vICkge1xuICAgICAgLy8gICB0aGlzLnByZXZpb3VzQ29tcG9uZW50ID0gcmVhY3RDb21wb25lbnQ7XG4gICAgICAvLyAgIGlmIChcbiAgICAgIC8vICAgICB0aGlzLnByZXZpb3VzQ29tcG9uZW50ICYmXG4gICAgICAvLyAgICAgbXNnLmNoZWNrZWQgIT09IG51bGwgJiZcbiAgICAgIC8vICAgICBtc2cuYWN0aW9uID09PSBcImNsaWNrXCJcbiAgICAgIC8vICAgKSB7XG4gICAgICAvLyAgICAgLy8gbWVzc2FnZSBpcyBzZW50IHdoZW4gc29tZXRoaW5nIGluIHRoZSBwb3B1cCBtZW51IGlzIHNlbGVjdGVkXG4gICAgICAvLyAgICAgdGhpcy5jcmVhdGVQb3B1cE1lbnUobXNnKTtcbiAgICAgIC8vICAgICAvLyB0aGlzLnNlbmRFdmVudChtc2cpO1xuICAgICAgLy8gICAgIHJldHVybjtcbiAgICAgIC8vICAgfVxuXG4gICAgICAvLyAgIC8vcHVzaGluZyBhIG1lc3NhZ2UgdG8gdGhlIGV2ZW50IGNhY2hlIHNlbmRzIGl0IHRvIHRoZSBhcGkgd2hlbiB0aGUgcmVjb25jaWxlIGNhbGxiYWNrIGlzIGNhbGxlZFxuICAgICAgLy8gICB0aGlzLmNvbXBvbmVudEV2ZW50Q2FjaGUucHVzaChtc2cpO1xuXG4gICAgICAvLyAgIHJldHVybjtcbiAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAvLyAgIHRoaXMuY2xlYXJFdmVudENhY2hlKCk7XG4gICAgICAvLyB9XG5cbiAgICAgIHRoaXMucHJldmlvdXNDb21wb25lbnQgPSByZWFjdENvbXBvbmVudDtcblxuICAgICAgLy8gbWVzc2FnZSBpcyBzZW50IHdoZW4gc29tZXRoaW5nIGluIHRoZSBwb3B1cCBtZW51IGlzIHNlbGVjdGVkXG4gICAgICBpZiAobW91c2VFdmVudD8ubWV0YUtleSkgdGhpcy5jcmVhdGVQb3B1cE1lbnUobXNnLCBtb3VzZUV2ZW50KTtcbiAgICAgIC8vIHRoaXMuc2VuZEV2ZW50KG1zZyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJlY29yZGluZyBldmVudFwiLCBlKTtcbiAgICB9XG4gIH07XG5cbiAgc2VuZEV2ZW50ID0gYXN5bmMgKG1lc3NhZ2U6IE1lc3NhZ2UpID0+IHtcbiAgICBsZXQgYWNjb3VudElkID0gKHdpbmRvdyBhcyB7IFtrZXk6IHN0cmluZ106IGFueSB9KVtcImRhdGFMYXllclwiXVswXVtcImFwaUtleVwiXTtcblxuICAgIC8vIHJhdGhlciBnZXQgYSA0MDMgdGhhbiBhIGJhZCByb3V0ZVxuICAgIGlmICghYWNjb3VudElkKSB7XG4gICAgICBhY2NvdW50SWQgPSAxO1xuICAgIH1cblxuICAgIGNvbnN0IHVybCA9IGAvL2xvY2FsaG9zdDozMDIwL2FwaS9hY2NvdW50cy8ke2FjY291bnRJZH0vZXZlbnRzL2A7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIG1vZGU6IFwiY29yc1wiLFxuICAgICAgY2FjaGU6IFwibm8tY2FjaGVcIixcbiAgICAgIGNyZWRlbnRpYWxzOiBcInNhbWUtb3JpZ2luXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdXJsOiB3aW5kb3cubG9jYXRpb24uaHJlZixcbiAgICAgICAgZXZlbnQ6IG1lc3NhZ2UsXG4gICAgICAgIC8vIFRPRE86IHRlc3Qgc2V0IGlkIHNob3VsZCBiZSBzZXQgd2hlbiBjcmVhdGluZy9sb2FkaW5nIHRlc3RzZXQgaW4gdGhlIHJ1bm5lclxuICAgICAgICBwbGFjZWhvbGRlcjogbnVsbCxcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKVxuICB9O1xuXG4gIGNoZWNrRm9yRXhpc3RpbmdUZXN0ID0gYXN5bmMgKGZpbGVwYXRoOiBzdHJpbmcpID0+IHtcbiAgICBsZXQgYWNjb3VudElkID0gKHdpbmRvdyBhcyB7IFtrZXk6IHN0cmluZ106IGFueSB9KVtcImRhdGFMYXllclwiXVswXVtcImFwaUtleVwiXTtcblxuICAgIC8vIHJhdGhlciBnZXQgYSA0MDMgdGhhbiBhIGJhZCByb3V0ZVxuICAgIGlmICghYWNjb3VudElkKSB7XG4gICAgICBhY2NvdW50SWQgPSAxO1xuICAgIH1cblxuICAgIGNvbnN0IHVyaUZpbGVwYXRoID0gZW5jb2RlVVJJKGZpbGVwYXRoKVxuICAgIGNvbnN0IHVybCA9IGAvL2xvY2FsaG9zdDozMDIwL2FwaS9hY2NvdW50cy8ke2FjY291bnRJZH0vZXZlbnRzLz9maWxlcGF0aD0ke3VyaUZpbGVwYXRofWA7XG5cbiAgICBjb25zb2xlLmxvZygndXJsIGhpdDogJywgdXJsLCB1cmlGaWxlcGF0aClcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgbW9kZTogXCJjb3JzXCIsXG4gICAgICBjYWNoZTogXCJuby1jYWNoZVwiLFxuICAgICAgY3JlZGVudGlhbHM6IFwic2FtZS1vcmlnaW5cIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpXG4gIH07XG59XG5cbig8YW55PndpbmRvdykuZXZlbnRSZWNvcmRlciA9IG5ldyBBc3NlcnRseUNsaWVudCgpO1xuKDxhbnk+d2luZG93KS5ldmVudFJlY29yZGVyLnN0YXJ0KCk7XG5cbiIsImltcG9ydCBDb29yZGluYXRlcyBmcm9tIFwiLi90eXBlcy9Db29yZGluYXRlc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29tcG9uZW50SW5mbyhjb21wb25lbnQ6IGFueSwgbWF4TmVzdDogbnVtYmVyLCByZXN1bHRBcnJheTogYW55KTogYW55IHtcbiAgY29uc29sZS5sb2coJ2dldENvbXBvbmVudEluZm86ICcsIGNvbXBvbmVudCwgcmVzdWx0QXJyYXkpXG5cbiAgaWYgKCFjb21wb25lbnQgfHwgbWF4TmVzdCA9PT0gMCkge1xuICAgIC8vIGNvbnNvbGUubG9nKCdyZXN1bHRBcnJheTogJywgcmVzdWx0QXJyYXkpXG4gICAgcmV0dXJuIHJlc3VsdEFycmF5XG4gIH1cblxuICBpZiAoY29tcG9uZW50Py5fZGVidWdTb3VyY2U/LmZpbGVOYW1lKSB7XG4gICAgLy8gdGhlIG93bmVyIG9mIHRoZSBub2RlIHdoZXJlIHRoZSAnc291cmNlJyBmaWxlbmFtZSBleGlzdHMgaXMgdGhlIGZpbGUgdGhhdCB5b3Ugd2FudCB0aGUgcHJvcHMgZm9yIFxuICAgIGNvbnN0IHByb3BzID0gZ2V0Q29tcG9uZW50UHJvcHMoY29tcG9uZW50Py5fZGVidWdPd25lcilcbiAgICBjb25zdCBuYW1lID0gZ2V0Q29tcG9uZW50TmFtZShjb21wb25lbnQ/Ll9kZWJ1Z093bmVyKVxuICAgIHJlc3VsdEFycmF5LnB1c2goe1xuICAgICAgZmlsZW5hbWU6IGNvbXBvbmVudD8uX2RlYnVnU291cmNlPy5maWxlTmFtZSwgXG4gICAgICAvLyB0aGUgbGluZSBudW1iZXIgaXMgcmVhbGx5IGZvciB0aGUgbmV4dCBjb21wb25lbnQgZG93biBpbiB0aGUgdHJlZSB0aGF0IGlzIGJlaW5nIGNhbGxlZCBmcm9tIHRoZSAnZmlsZW5hbWUnXG4gICAgICBsaW5lbnVtYmVyOiBjb21wb25lbnQ/Ll9kZWJ1Z1NvdXJjZT8ubGluZU51bWJlciwgXG4gICAgICBwcm9wczogcHJvcHMsIFxuICAgICAgLy8gaWYgaXQncyBjb21wb25lbnQgIHN0ci5zcGxpdCgnXFxcXCcpLnBvcC5zcGxpdChgL2ApLnBvcCgpLnNwbGl0KCcuJylbMF1cbiAgICAgIGNvbXBvbmVudE5hbWU6IG5hbWUgPT09ICdDb21wb25lbnQnID8gXG4gICAgICAgIGNvbXBvbmVudD8uX2RlYnVnU291cmNlPy5maWxlTmFtZT8uc3BsaXQoJ1xcXFwnKS5wb3AoKS5zcGxpdChgL2ApLnBvcCgpLnNwbGl0KCcuJylbMF0gOiBuYW1lXG4gICAgfSlcbiAgICByZXR1cm4gZ2V0Q29tcG9uZW50SW5mbyhjb21wb25lbnQ/Ll9kZWJ1Z093bmVyLG1heE5lc3QtMSxyZXN1bHRBcnJheSlcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZ2V0Q29tcG9uZW50SW5mbyhjb21wb25lbnQ/Ll9kZWJ1Z093bmVyLG1heE5lc3QtMSxyZXN1bHRBcnJheSlcbiAgfVxuXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb21wb25lbnRQcm9wcyhjb21wb25lbnQ6IGFueSwgcHJvcHMgPSB7fSk6IGFueSB7XG4gIGlmICghY29tcG9uZW50KSB7XG4gICAgZnVuY3Rpb25TdHJpbmdpZnkocHJvcHMpO1xuICAgIHJldHVybiBwcm9wcztcbiAgfVxuXG4gIGNvbnN0IG5ld1Byb3BzID0gY29tcG9uZW50LnBlbmRpbmdQcm9wc1xuICAgID8geyAuLi5wcm9wcywgLi4uY29tcG9uZW50LnBlbmRpbmdQcm9wcyB9XG4gICAgOiBwcm9wcztcbiAgZGVsZXRlIG5ld1Byb3BzLmNoaWxkcmVuO1xuXG4gIGlmIChcbiAgICBjb21wb25lbnQ/LnR5cGU/Ll9fcHJvdG9fXyAmJlxuICAgIFtcIkNvbXBvbmVudFwiLCBcIlB1cmVDb21wb25lbnRcIl0uaW5jbHVkZXMoY29tcG9uZW50LnR5cGUuX19wcm90b19fLm5hbWUpXG4gICkge1xuICAgIGZ1bmN0aW9uU3RyaW5naWZ5KG5ld1Byb3BzKTtcbiAgICByZXR1cm4gbmV3UHJvcHM7XG4gIH1cblxuICByZXR1cm4gZ2V0Q29tcG9uZW50UHJvcHMoY29tcG9uZW50Ll9kZWJ1Z093bmVyLCBuZXdQcm9wcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb21wb25lbnROYW1lKGZpYmVyOiBhbnkpOiBhbnkge1xuICBpZiAoIWZpYmVyKSByZXR1cm4gbnVsbDtcblxuICBpZiAoZmliZXIuZWxlbWVudFR5cGUgJiYgZmliZXIuZWxlbWVudFR5cGUubmFtZSkge1xuICAgIHJldHVybiBmaWJlci5lbGVtZW50VHlwZS5uYW1lO1xuICB9XG5cbiAgaWYgKGZpYmVyLmVsZW1lbnRUeXBlICYmIGZpYmVyLmVsZW1lbnRUeXBlLmRpc3BsYXlOYW1lKSB7XG4gICAgcmV0dXJuIGZpYmVyLmVsZW1lbnRUeXBlLmRpc3BsYXlOYW1lO1xuICB9XG5cbiAgaWYgKGZpYmVyLnR5cGUuZGlzcGxheU5hbWUpIHtcbiAgICByZXR1cm4gZmliZXIudHlwZS5kaXNwbGF5TmFtZTtcbiAgfVxuXG4gIGlmIChmaWJlci50eXBlLm5hbWUpIHtcbiAgICByZXR1cm4gZmliZXIudHlwZS5uYW1lO1xuICB9XG4gIHJldHVybiBnZXRDb21wb25lbnROYW1lKGZpYmVyLl9kZWJ1Z093bmVyKTtcbn1cblxuY29uc3QgZXZlbnRzV2l0aENvb3JkaW5hdGVzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0ge1xuICBtb3VzZXVwOiB0cnVlLFxuICBtb3VzZWRvd246IHRydWUsXG4gIG1vdXNlbW92ZTogdHJ1ZSxcbiAgbW91c2VvdmVyOiB0cnVlLFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvb3JkaW5hdGVzKGV2ZW50OiBFdmVudCk6IENvb3JkaW5hdGVzIHwgbnVsbCB7XG4gIGNvbnN0IG1vdXNlRXZlbnQgPSBldmVudCBhcyBNb3VzZUV2ZW50O1xuXG4gIHJldHVybiBldmVudHNXaXRoQ29vcmRpbmF0ZXNbZXZlbnQudHlwZV1cbiAgICA/IHsgeDogbW91c2VFdmVudC5jbGllbnRYLCB5OiBtb3VzZUV2ZW50LmNsaWVudFkgfVxuICAgIDogbnVsbDtcbn1cblxuLy8gbWFwIHJlYWN0IGNsYXNzZXMgdG8gZG9tIGVsZW1lbnRzXG5leHBvcnQgZnVuY3Rpb24gZmluZFJlYWN0RWxlbWVudERVUktBKHRhcmdldDogRXZlbnRUYXJnZXQpOiBhbnkge1xuICAvLyBjb25zb2xlLmRpcih0YXJnZXQpXG4gIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHRhcmdldCkuZmluZCgoa2V5KSA9PlxuICAgIGtleS5zdGFydHNXaXRoKFwiX19yZWFjdEludGVybmFsSW5zdGFuY2UkXCIpXG4gICk7XG4gIC8vIGNvbnNvbGUubG9nKCdrZXk6ICcsIGtleSlcbiAgLy8gY3JlYXRlcyBhbiBvYmplY3Qgb3V0IG9mIHRoZSB0YXJnZXQgcGFzc2VkXG4gIGNvbnN0IHRhcmdldE1hcCA9IHRhcmdldCBhcyB7IFtrZXk6IHN0cmluZ106IGFueSB9O1xuXG4gIGNvbnN0IGludGVybmFsSW5zdGFuY2UgPSBrZXkgPyB0YXJnZXRNYXBba2V5XSA6IG51bGw7XG4gIC8vIGNvbnNvbGUubG9nKCdSZWFjdCBOb2RlIGlmIEZvdW5kOiAnLCBpbnRlcm5hbEluc3RhbmNlKVxuICBpZiAoaW50ZXJuYWxJbnN0YW5jZSA9PSBudWxsKSByZXR1cm4gbnVsbDtcblxuICAvLyBjb25zb2xlLmxvZygnaW50ZXJuYWxJbnN0YW5jZTI6ICcsIGludGVybmFsSW5zdGFuY2UpXG4gIC8vIHJldHVybiBpbnRlcm5hbEluc3RhbmNlLl9kZWJ1Z093bmVyXG4gIC8vICAgPyBpbnRlcm5hbEluc3RhbmNlLl9kZWJ1Z093bmVyLnN0YXRlTm9kZVxuICAvLyAgIDogaW50ZXJuYWxJbnN0YW5jZS5yZXR1cm4uc3RhdGVOb2RlO1xuXG4gIHJldHVybiBpbnRlcm5hbEluc3RhbmNlO1xuXG4gIC8vIGZvciAobGV0IGtleTogc3RyaW5nIGluIHRhcmdldCkge1xuICAvLyAgIGlmIChrZXkuc3RhcnRzV2l0aChcIl9fcmVhY3RJbnRlcm5hbEluc3RhbmNlJFwiKSkge1xuICAvLyAgICAgLy8gY29uc29sZS5sb2coJ2tleXMgaW4gdGhlIGZpbmQgUmVhY3RFbGVtZW50JywgdGFyZ2V0W2tleV0pXG4gIC8vICAgICByZXR1cm4gdGFyZ2V0W2tleV07XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vIHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmluZFJlYWN0RWxlbWVudCh0YXJnZXQ6IEV2ZW50VGFyZ2V0KTogYW55IHtcbiAgLy8gY29uc3Qga2V5ID0gT2JqZWN0LmtleXModGFyZ2V0KS5maW5kKChrZXkpID0+XG4gIC8vICAga2V5LnN0YXJ0c1dpdGgoXCJfX3JlYWN0SW50ZXJuYWxJbnN0YW5jZSRcIilcbiAgLy8gKTtcbiAgY29uc3QgdGFyZ2V0TWFwID0gdGFyZ2V0IGFzIHsgW2tleTogc3RyaW5nXTogYW55IH07XG4gIC8vIGNvbnN0IGludGVybmFsSW5zdGFuY2UgPSBrZXkgPyB0YXJnZXRNYXBba2V5XSA6IG51bGw7XG4gIC8vIGlmIChpbnRlcm5hbEluc3RhbmNlID09IG51bGwpIHJldHVybiBudWxsO1xuICAvLyByZXR1cm4gaW50ZXJuYWxJbnN0YW5jZS5fZGVidWdPd25lclxuICAvLyAgID8gaW50ZXJuYWxJbnN0YW5jZS5fZGVidWdPd25lci5zdGF0ZU5vZGVcbiAgLy8gICA6IGludGVybmFsSW5zdGFuY2UucmV0dXJuLnN0YXRlTm9kZTtcbiAgZm9yIChsZXQga2V5IGluIHRhcmdldE1hcCkge1xuICAgIGlmIChrZXkuc3RhcnRzV2l0aChcIl9fcmVhY3RJbnRlcm5hbEluc3RhbmNlJFwiKSkge1xuICAgICAgLy8gY29uc29sZS5sb2coJ2tleXMgaW4gdGhlIGZpbmQgUmVhY3RFbGVtZW50JywgdGFyZ2V0W2tleV0pXG4gICAgICByZXR1cm4gdGFyZ2V0TWFwW2tleV07XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBmdW5jdGlvblN0cmluZ2lmeShvYmo6IGFueSk6IHZvaWQge1xuICBmb3IgKGxldCBrIGluIG9iaikge1xuICAgIGlmIChvYmpba10gJiYge30udG9TdHJpbmcuY2FsbChvYmpba10pID09PSBcIltvYmplY3QgRnVuY3Rpb25dXCIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIG9ialtrXSA9IFwiXCIgKyBvYmpba107XG4gICAgICAgIC8vIC8vIGdldCByaWQgb2YgdGhlIGV4dHJhIGxpbmUgbWFya2Vyc1xuICAgICAgICAvLyBvYmpba10gPSBvYmpba10ucmVwbGFjZSgvKFxcclxcbnxcXG58XFxyKS9nbSwgXCJcIik7XG4gICAgICAgIG9ialtrXSA9IFwiW0Z1bmN0aW9uXVwiXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzdHJpbmdpZnlpbmcgcHJvcFwiLCBlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgc3RyaXBFeHRyYUNvbXBvbmVudFByb3BzKG9iaik7XG59XG5cblxuXG5mdW5jdGlvbiBzdHJpcEV4dHJhQ29tcG9uZW50UHJvcHMocHJvcHM6IGFueSk6IHZvaWQge1xuICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocHJvcHMpO1xuICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgaWYgKFxuICAgICAgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHByb3BzW2tleV0pID09PSBcIltvYmplY3QgT2JqZWN0XVwiICYmXG4gICAgICAocHJvcHNba2V5XS5oYXNPd25Qcm9wZXJ0eShcIl9vd25lclwiKSB8fFxuICAgICAgICBrZXkgPT09IFwiaW5wdXRSZWZcIiB8fFxuICAgICAgICBrZXkgPT09IFwiSW5wdXRQcm9wc1wiKVxuICAgICkge1xuICAgICAgZGVsZXRlIHByb3BzW2tleV07XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBFdmVudFR5cGUsIFJlY29uY2lsZVR5cGUgfSBmcm9tIFwiLi90eXBlcy9FdmVudFR5cGVcIjtcbmltcG9ydCB7IFJlY29yZGVyQ29uZmlnIH0gZnJvbSBcIi4vdHlwZXMvUmVjb3JkZXJDb25maWdcIjtcblxuZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgV2luZG93IHtcbiAgICByZWNvcmRlckFkZGVkQ29udHJvbExpc3RlbmVyczogYm9vbGVhbjtcbiAgICBkYXRhTGF5ZXI6IGFueVtdO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEV2ZW50UmVjb3JkZXIge1xuICBwcml2YXRlIGV2ZW50Q2FsbGJhY2s6IChldmVudDogRXZlbnQpID0+IGFueTtcbiAgcHJpdmF0ZSByZWNvbmNpbGVDYWxsYmFjazogKGV2ZW50OiBFdmVudCkgPT4gYW55O1xuICBwcml2YXRlIHJlY29yZEV2ZW50czogRXZlbnRUeXBlW10gPSBbXTtcbiAgcHJpdmF0ZSByZWNvbmNpbGVFdmVudHM6IFJlY29uY2lsZVR5cGVbXSA9IFtcImJsdXJcIiwgXCJmb2N1c1wiLCBcImNoYW5nZVwiXTtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IFJlY29yZGVyQ29uZmlnKSB7XG4gICAgY29uc3Qge1xuICAgICAgZXZlbnRDYWxsYmFjayxcbiAgICAgIHJlY29uY2lsZUNhbGxiYWNrLFxuICAgICAgcmVjb3JkRXZlbnRzLFxuICAgICAgcmVjb25jaWxlRXZlbnRzID0gbnVsbCxcbiAgICB9ID0gY29uZmlnO1xuICAgIHRoaXMuZXZlbnRDYWxsYmFjayA9IGV2ZW50Q2FsbGJhY2s7XG4gICAgdGhpcy5yZWNvbmNpbGVDYWxsYmFjayA9IHJlY29uY2lsZUNhbGxiYWNrO1xuICAgIHRoaXMucmVjb3JkRXZlbnRzID0gcmVjb3JkRXZlbnRzO1xuICAgIGlmIChyZWNvbmNpbGVFdmVudHMpIHtcbiAgICAgIHRoaXMucmVjb25jaWxlRXZlbnRzID0gcmVjb25jaWxlRXZlbnRzO1xuICAgIH1cbiAgfVxuXG4gIGFkZEFsbExpc3RlbmVycyA9ICgpID0+IHtcbiAgICB0aGlzLnJlY29yZEV2ZW50cy5mb3JFYWNoKChldmVudCkgPT4ge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIHRoaXMuZXZlbnRDYWxsYmFjaywgdHJ1ZSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnJlY29uY2lsZUV2ZW50cy5mb3JFYWNoKChldmVudCkgPT4ge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIHRoaXMucmVjb25jaWxlQ2FsbGJhY2ssIHRydWUpO1xuICAgIH0pO1xuICB9O1xuXG4gIHJlbW92ZUFsbExpc3RlbmVycyA9ICgpID0+IHtcbiAgICB0aGlzLnJlY29yZEV2ZW50cy5mb3JFYWNoKChldmVudCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIHRoaXMuZXZlbnRDYWxsYmFjaywgdHJ1ZSk7XG4gICAgfSk7XG4gICAgdGhpcy5yZWNvbmNpbGVFdmVudHMuZm9yRWFjaCgoZXZlbnQ6IFJlY29uY2lsZVR5cGUpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCB0aGlzLnJlY29uY2lsZUNhbGxiYWNrLCB0cnVlKTtcbiAgICB9KTtcbiAgfTtcblxuICBzdGFydCA9ICgpID0+IHtcbiAgICBpZiAoIXdpbmRvdy5yZWNvcmRlckFkZGVkQ29udHJvbExpc3RlbmVycykge1xuICAgICAgdGhpcy5hZGRBbGxMaXN0ZW5lcnMoKTtcbiAgICAgIHdpbmRvdy5yZWNvcmRlckFkZGVkQ29udHJvbExpc3RlbmVycyA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIHN0b3AgPSAoKSA9PiB7XG4gICAgaWYgKHdpbmRvdy5yZWNvcmRlckFkZGVkQ29udHJvbExpc3RlbmVycykge1xuICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgIHdpbmRvdy5yZWNvcmRlckFkZGVkQ29udHJvbExpc3RlbmVycyA9IGZhbHNlO1xuICAgIH1cbiAgfTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=