!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function c(e){try{u(o.next(e))}catch(e){i(e)}}function l(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,l)}u((o=o.apply(e,n||[])).next())}))},i=this&&this.__generator||function(e,n){var t,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=c.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var l=t(1),u=c(t(2)),a=function(){var e=this;this.eventsToRecord=["click","change"],this.componentEventCache=[],this.previousComponent=null,this.previousMsg=null,this.start=function(){e.eventRecorder.start()},this.stop=function(){e.eventRecorder.stop()},this.clearEventCache=function(){e.componentEventCache=[]},this.reconcileEventCache=function(n){(n.target?l.findReactElement(n.target):null)!==e.previousComponent&&(e.componentEventCache.forEach((function(e){console.log("in the reconcile")})),e.clearEventCache())},this.removeMenusByClassname=function(e){var n=Array.from(document.getElementsByClassName(e));null==n||n.map((function(e){return e.remove()}))},this.removeSingleMenu=function(n){return r(e,void 0,void 0,(function(){var e;return i(this,(function(t){return null==(e=document.getElementById(n))||e.remove(),[2]}))}))},this.setupMenuDiv=function(e){var n="componentMenu"+(new Date).getTime(),t=document.createElement("DIV");return t.setAttribute("id",n),t.setAttribute("class","componentMenu"),document.body.appendChild(t),t.style.position="absolute",t.style.left=e.x+"px",t.style.top=e.y+"px",t.style.zIndex="9999999999999",n},this.appendButton=function(e,n,t){var o,r;void 0===t&&(t=void 0);var i=document.createElement("BUTTON");i.style.width="150px",i.innerHTML=n,t&&t.backgroundColor&&(i.style.backgroundColor=t.backgroundColor),null===(o=document.getElementById(e))||void 0===o||o.appendChild(i);var c=document.createElement("br");return null===(r=document.getElementById(e))||void 0===r||r.appendChild(c),i},this.createPopupMenu=function(n,t){var o;e.removeMenusByClassname("componentMenu");var c=e.setupMenuDiv(t);null===(o=null==n?void 0:n.componentInfo)||void 0===o||o.map((function(t){var o,l;console.log("button val: ",t);var u=document.createElement("BUTTON");if(u.style.width="150px",u.innerHTML=null==t?void 0:t.componentName,u.innerHTML){u.addEventListener("click",(function(t){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.componentMenuClick(t,c,n)];case 1:return[2,e.sent()]}}))}))})),null===(o=document.getElementById(c))||void 0===o||o.appendChild(u);var a=document.createElement("br");null===(l=document.getElementById(c))||void 0===l||l.appendChild(a)}})),e.appendButton(c,"Cancel").addEventListener("click",(function(){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.removeSingleMenu(c)];case 1:return[2,e.sent()]}}))}))}))},this.createExistingTestMenu=function(n,t){return r(e,void 0,void 0,(function(){var e,o,c,l=this;return i(this,(function(u){return e=this.setupMenuDiv(n),null==(o=t.describeBlocks)||o.map((function(n){var t,o,r=document.createElement("BUTTON");r.style.width="150px",r.innerHTML=n,null===(t=document.getElementById(e))||void 0===t||t.appendChild(r);var i=document.createElement("br");null===(o=document.getElementById(e))||void 0===o||o.appendChild(i)})),c=this.appendButton(e,"Create New Test"),this.appendButton(e,"Cancel",{backgroundColor:"#df2a2a7a"}).addEventListener("click",(function(){return r(l,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this.removeSingleMenu(e)];case 1:return[2,n.sent()]}}))}))})),[2,{newTestBtn:c,existingTestMenuID:e}]}))}))},this.componentMenuClick=function(n,t,c){return r(e,void 0,void 0,(function(){var e,l,u,a,s=this;return i(this,(function(d){switch(d.label){case 0:return[4,this.removeSingleMenu(t)];case 1:return d.sent(),e=null===(a=c.componentInfo)||void 0===a?void 0:a.reduce((function(e,t){var r;return t.componentName===(null===(r=n.target)||void 0===r?void 0:r.innerHTML)?o({},t):e}),null),null==n||n.stopPropagation(),[4,this.checkForExistingTest(null==e?void 0:e.filename)];case 2:return l=d.sent(),[4,this.createExistingTestMenu(n,l)];case 3:return(u=d.sent()).newTestBtn.addEventListener("click",(function(){return r(s,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this.createNewTest(o(o({},c),{componentInfo:e,checkedEvent:l.checkedEvent}))];case 1:return n.sent(),[4,this.removeSingleMenu(u.existingTestMenuID)];case 2:return n.sent(),[2]}}))}))})),[2]}}))}))},this.getMessage=function(e,n){var t,r,i,c=n.target||n.srcElement,u=c,a=c,s=l.getComponentInfo(e,10,[]),d=null===(r=null===(t=null==s?void 0:s.slice(0))||void 0===t?void 0:t.reverse())||void 0===r?void 0:r.reduce((function(e,n){var t;return(null===(t=n.props)||void 0===t?void 0:t.onClick)?o({},n):e}),null);return{action:n.type,checked:(null===(i=null==n?void 0:n.target)||void 0===i?void 0:i.hasOwnProperty("checked"))?u.checked:null,coordinates:l.getCoordinates(n),href:a.href?a.href:null,keyCode:n.keyCode?n.keyCode:null,tagName:u.tagName,tagType:u.type,textContent:u.textContent||u.innerText,timestamp:(new Date).getTime(),value:u.value,writeTestLocation:"",componentInfo:s,clickHandlerComponent:d,checkedEvent:void 0}},this.recordEvent=function(n){var t,o,r=n.target,i=n;if(!(null===(o=null===(t=null==r?void 0:r.parentElement)||void 0===t?void 0:t.getAttribute("id"))||void 0===o?void 0:o.includes("componentMenu"))&&n.target)try{if(e.previousMsg&&("change"===n.type||"click"===n.type)&&e.previousMsg&&"click"===e.previousMsg.action&&(new Date).getTime()-e.previousMsg.timestamp<100)return void console.log("message not send due to time");var c=l.findReactElement(n.target),u=e.getMessage(c,n);console.log("reactComponent and message in RECORD_EVENT: ",c,u),localStorage.setItem("lastEvent",JSON.stringify(u)),e.previousMsg=u,e.previousComponent=c,(null==i?void 0:i.metaKey)&&e.createPopupMenu(u,i)}catch(e){console.error("Error recording event",e)}},this.createNewTest=function(n){return r(e,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return e=window.dataLayer[0].apiKey,console.log("message: ",n),e||(e=1),[4,fetch("//localhost:3020/api/accounts/"+e+"/events/",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:window.location.href,event:n,placeholder:null})})];case 1:return[2,t.sent().json()]}}))}))},this.checkForExistingTest=function(n){return r(e,void 0,void 0,(function(){var e,t,o;return i(this,(function(r){switch(r.label){case 0:return(e=window.dataLayer[0].apiKey)||(e=1),t=encodeURI(n),o="//localhost:3020/api/accounts/"+e+"/events/?filepath="+t,console.log("url hit: ",o,t),[4,fetch(o,{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"}})];case 1:return[2,r.sent().json()]}}))}))},this.eventRecorder=new u.default({recordEvents:this.eventsToRecord,eventCallback:this.recordEvent,reconcileCallback:this.reconcileEventCache})};n.default=a,window.eventRecorder=new a,window.eventRecorder.start()},function(e,n,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function r(e,n){var t;if(void 0===n&&(n={}),!e)return l(n),n;var i=e.pendingProps?o(o({},n),e.pendingProps):n;return delete i.children,(null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.__proto__)&&["Component","PureComponent"].includes(e.type.__proto__.name)?(l(i),i):r(e._debugOwner,i)}function i(e){return e?e.elementType&&e.elementType.name?e.elementType.name:e.elementType&&e.elementType.displayName?e.elementType.displayName:e.type.displayName?e.type.displayName:e.type.name?e.type.name:i(e._debugOwner):null}Object.defineProperty(n,"__esModule",{value:!0}),n.functionStringify=n.findReactElement=n.findReactElementDURKA=n.getCoordinates=n.getComponentName=n.getComponentProps=n.getComponentInfo=void 0,n.getComponentInfo=function e(n,t,o){var c,l,u,a,s;if(console.log("getComponentInfo: ",n,o),!n||0===t)return o;if(null===(c=null==n?void 0:n._debugSource)||void 0===c?void 0:c.fileName){var d=r(null==n?void 0:n._debugOwner),v=i(null==n?void 0:n._debugOwner);return o.push({filename:null===(l=null==n?void 0:n._debugSource)||void 0===l?void 0:l.fileName,linenumber:null===(u=null==n?void 0:n._debugSource)||void 0===u?void 0:u.lineNumber,props:d,componentName:"Component"===v?null===(s=null===(a=null==n?void 0:n._debugSource)||void 0===a?void 0:a.fileName)||void 0===s?void 0:s.split("\\").pop().split("/").pop().split(".")[0]:v}),e(null==n?void 0:n._debugOwner,t-1,o)}return e(null==n?void 0:n._debugOwner,t-1,o)},n.getComponentProps=r,n.getComponentName=i;var c={mouseup:!0,mousedown:!0,mousemove:!0,mouseover:!0};function l(e){for(var n in e)if(e[n]&&"[object Function]"==={}.toString.call(e[n]))try{e[n]="[Function]"}catch(e){console.error("Error stringifying prop",e)}!function(e){for(var n=Object.keys(e),t=0,o=n;t<o.length;t++){var r=o[t];"[object Object]"!==Object.prototype.toString.call(e[r])||!e[r].hasOwnProperty("_owner")&&"inputRef"!==r&&"InputProps"!==r||delete e[r]}}(e)}n.getCoordinates=function(e){var n=e;return c[e.type]?{x:n.clientX,y:n.clientY}:null},n.findReactElementDURKA=function(e){var n=Object.keys(e).find((function(e){return e.startsWith("__reactInternalInstance$")})),t=n?e[n]:null;return null==t?null:t},n.findReactElement=function(e){var n=e;for(var t in n)if(t.startsWith("__reactInternalInstance$"))return n[t];return null},n.functionStringify=l},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){var n=this;this.recordEvents=[],this.reconcileEvents=["blur","focus","change"],this.addAllListeners=function(){n.recordEvents.forEach((function(e){window.addEventListener(e,n.eventCallback,!0)})),n.reconcileEvents.forEach((function(e){window.addEventListener(e,n.reconcileCallback,!0)}))},this.removeAllListeners=function(){n.recordEvents.forEach((function(e){window.removeEventListener(e,n.eventCallback,!0)})),n.reconcileEvents.forEach((function(e){window.removeEventListener(e,n.reconcileCallback,!0)}))},this.start=function(){window.recorderAddedControlListeners||(n.addAllListeners(),window.recorderAddedControlListeners=!0)},this.stop=function(){window.recorderAddedControlListeners&&(n.removeAllListeners(),window.recorderAddedControlListeners=!1)};var t=e.eventCallback,o=e.reconcileCallback,r=e.recordEvents,i=e.reconcileEvents,c=void 0===i?null:i;this.eventCallback=t,this.reconcileCallback=o,this.recordEvents=r,c&&(this.reconcileEvents=c)};n.default=o}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NsaWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V2ZW50LXJlY29yZGVyLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiZXZlbnRzVG9SZWNvcmQiLCJjb21wb25lbnRFdmVudENhY2hlIiwicHJldmlvdXNDb21wb25lbnQiLCJwcmV2aW91c01zZyIsInN0YXJ0IiwiZXZlbnRSZWNvcmRlciIsInN0b3AiLCJjbGVhckV2ZW50Q2FjaGUiLCJyZWNvbmNpbGVFdmVudENhY2hlIiwiZXZlbnQiLCJ0YXJnZXQiLCJmaW5kUmVhY3RFbGVtZW50IiwiZm9yRWFjaCIsIm1zZyIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmVNZW51c0J5Q2xhc3NuYW1lIiwiY2xhc3NuYW1lIiwicHJldmlvdXNNZW51cyIsIkFycmF5IiwiZnJvbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsIm1hcCIsInZhbCIsInJlbW92ZSIsInJlbW92ZVNpbmdsZU1lbnUiLCJlbElEIiwibWVudURpdiIsImdldEVsZW1lbnRCeUlkIiwic2V0dXBNZW51RGl2IiwibW91c2VFdmVudCIsImRpdklEIiwiRGF0ZSIsImdldFRpbWUiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYm9keSIsImFwcGVuZENoaWxkIiwic3R5bGUiLCJwb3NpdGlvbiIsImxlZnQiLCJ4IiwidG9wIiwieSIsInpJbmRleCIsImFwcGVuZEJ1dHRvbiIsImxhYmVsIiwic3R5bGVzIiwiYnRuIiwid2lkdGgiLCJpbm5lckhUTUwiLCJiYWNrZ3JvdW5kQ29sb3IiLCJiciIsImNyZWF0ZVBvcHVwTWVudSIsIm1lc3NhZ2UiLCJjb21wb25lbnRJbmZvIiwiY29tcG9uZW50TmFtZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0aGlzIiwiY29tcG9uZW50TWVudUNsaWNrIiwiY3JlYXRlRXhpc3RpbmdUZXN0TWVudSIsImV4aXN0aW5nVGVzdFJlc3BvbnNlIiwiZXhpc3RpbmdUZXN0RGl2SUQiLCJkZXNjcmliZUJsb2NrcyIsIm5ld1Rlc3RCdG4iLCJleGlzdGluZ1Rlc3RNZW51SUQiLCJzZWxlY3RlZENvbXBvbmVudCIsInJlZHVjZSIsImFjYyIsImN1cnIiLCJzdG9wUHJvcGFnYXRpb24iLCJjaGVja0ZvckV4aXN0aW5nVGVzdCIsImZpbGVuYW1lIiwiZXhpc3RpbmdUZXN0TWVudVJlc3BvbnNlIiwiY3JlYXRlTmV3VGVzdCIsImNoZWNrZWRFdmVudCIsImdldE1lc3NhZ2UiLCJyZWFjdENvbXBvbmVudCIsInNyY0VsZW1lbnQiLCJpbnB1dFRhcmdldCIsImxpbmtUYXJnZXQiLCJnZXRDb21wb25lbnRJbmZvIiwiY2xpY2tIYW5kbGVyIiwic2xpY2UiLCJyZXZlcnNlIiwiYWNjdW11bGF0b3IiLCJjdXJyZW50VmFsdWUiLCJwcm9wcyIsIm9uQ2xpY2siLCJhY3Rpb24iLCJ0eXBlIiwiY2hlY2tlZCIsImNvb3JkaW5hdGVzIiwiZ2V0Q29vcmRpbmF0ZXMiLCJocmVmIiwia2V5Q29kZSIsInRhZ05hbWUiLCJ0YWdUeXBlIiwidGV4dENvbnRlbnQiLCJpbm5lclRleHQiLCJ0aW1lc3RhbXAiLCJ3cml0ZVRlc3RMb2NhdGlvbiIsImNsaWNrSGFuZGxlckNvbXBvbmVudCIsInVuZGVmaW5lZCIsInJlY29yZEV2ZW50Iiwibm9kZVRhcmdldCIsInBhcmVudEVsZW1lbnQiLCJnZXRBdHRyaWJ1dGUiLCJpbmNsdWRlcyIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwibWV0YUtleSIsImUiLCJlcnJvciIsImFjY291bnRJZCIsIndpbmRvdyIsImZldGNoIiwibWV0aG9kIiwiY2FjaGUiLCJjcmVkZW50aWFscyIsImhlYWRlcnMiLCJ1cmwiLCJsb2NhdGlvbiIsInBsYWNlaG9sZGVyIiwianNvbiIsImZpbGVwYXRoIiwidXJpRmlsZXBhdGgiLCJlbmNvZGVVUkkiLCJyZWNvcmRFdmVudHMiLCJldmVudENhbGxiYWNrIiwicmVjb25jaWxlQ2FsbGJhY2siLCJBc3NlcnRseUNsaWVudCIsImdldENvbXBvbmVudFByb3BzIiwiY29tcG9uZW50IiwiZnVuY3Rpb25TdHJpbmdpZnkiLCJuZXdQcm9wcyIsInBlbmRpbmdQcm9wcyIsImNoaWxkcmVuIiwiX19wcm90b19fIiwiX2RlYnVnT3duZXIiLCJnZXRDb21wb25lbnROYW1lIiwiZmliZXIiLCJlbGVtZW50VHlwZSIsImRpc3BsYXlOYW1lIiwibWF4TmVzdCIsInJlc3VsdEFycmF5IiwiX2RlYnVnU291cmNlIiwiZmlsZU5hbWUiLCJwdXNoIiwibGluZW51bWJlciIsImxpbmVOdW1iZXIiLCJzcGxpdCIsInBvcCIsImV2ZW50c1dpdGhDb29yZGluYXRlcyIsIm1vdXNldXAiLCJtb3VzZWRvd24iLCJtb3VzZW1vdmUiLCJtb3VzZW92ZXIiLCJvYmoiLCJrIiwidG9TdHJpbmciLCJrZXlzIiwic3RyaXBFeHRyYUNvbXBvbmVudFByb3BzIiwiY2xpZW50WCIsImNsaWVudFkiLCJmaW5kIiwic3RhcnRzV2l0aCIsImludGVybmFsSW5zdGFuY2UiLCJ0YXJnZXRNYXAiLCJjb25maWciLCJyZWNvbmNpbGVFdmVudHMiLCJhZGRBbGxMaXN0ZW5lcnMiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicmVjb3JkZXJBZGRlZENvbnRyb2xMaXN0ZW5lcnMiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2QixHQUZBMUIsRUFBb0JrQixFQUFFTyxHQUN0QlgsT0FBT0MsZUFBZVUsRUFBSSxVQUFXLENBQUVULFlBQVksRUFBTUssTUFBT0EsSUFDdEQsRUFBUEUsR0FBNEIsaUJBQVRG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bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7XG4gIGZpbmRSZWFjdEVsZW1lbnQsXG4gIGdldENvb3JkaW5hdGVzLFxuICBnZXRDb21wb25lbnROYW1lLFxuICBnZXRDb21wb25lbnRQcm9wcyxcbiAgZ2V0Q29tcG9uZW50SW5mb1xufSBmcm9tIFwiLi91dGlsc1wiO1xuXG5cbmltcG9ydCBFdmVudFJlY29yZGVyIGZyb20gXCIuL2V2ZW50LXJlY29yZGVyXCI7XG5pbXBvcnQgQ2xpZW50SW50ZXJmYWNlIGZyb20gXCIuL3R5cGVzL0NsaWVudFwiO1xuaW1wb3J0IE1lc3NhZ2UgZnJvbSBcIi4vdHlwZXMvTWVzc2FnZVwiO1xuaW1wb3J0IHsgRXZlbnRUeXBlIH0gZnJvbSBcIi4vdHlwZXMvRXZlbnRUeXBlXCI7XG5cbmludGVyZmFjZSBDb21wb25lbnQge1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBc3NlcnRseUNsaWVudCBpbXBsZW1lbnRzIENsaWVudEludGVyZmFjZSB7XG4gIGV2ZW50c1RvUmVjb3JkOiBFdmVudFR5cGVbXSA9IFtcImNsaWNrXCIsIFwiY2hhbmdlXCJdO1xuXG4gIHByaXZhdGUgZXZlbnRSZWNvcmRlcjogRXZlbnRSZWNvcmRlcjtcbiAgcHJpdmF0ZSBjb21wb25lbnRFdmVudENhY2hlOiBNZXNzYWdlW10gPSBbXTtcbiAgcHJpdmF0ZSBwcmV2aW91c0NvbXBvbmVudDogQ29tcG9uZW50IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgcHJldmlvdXNNc2c6IE1lc3NhZ2UgfCBudWxsID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmV2ZW50UmVjb3JkZXIgPSBuZXcgRXZlbnRSZWNvcmRlcih7XG4gICAgICByZWNvcmRFdmVudHM6IHRoaXMuZXZlbnRzVG9SZWNvcmQsXG4gICAgICBldmVudENhbGxiYWNrOiB0aGlzLnJlY29yZEV2ZW50LFxuICAgICAgcmVjb25jaWxlQ2FsbGJhY2s6IHRoaXMucmVjb25jaWxlRXZlbnRDYWNoZSxcbiAgICB9KTtcbiAgfVxuXG4gIHN0YXJ0ID0gKCkgPT4ge1xuICAgIHRoaXMuZXZlbnRSZWNvcmRlci5zdGFydCgpO1xuICB9O1xuXG4gIHN0b3AgPSAoKSA9PiB7XG4gICAgdGhpcy5ldmVudFJlY29yZGVyLnN0b3AoKTtcbiAgfTtcblxuICBjbGVhckV2ZW50Q2FjaGUgPSAoKSA9PiB7XG4gICAgdGhpcy5jb21wb25lbnRFdmVudENhY2hlID0gW107XG4gIH07XG5cbiAgcmVjb25jaWxlRXZlbnRDYWNoZSA9IChldmVudDogRXZlbnQpID0+IHtcbiAgICBjb25zdCByZWFjdENvbXBvbmVudCA9IGV2ZW50LnRhcmdldCA/IGZpbmRSZWFjdEVsZW1lbnQoZXZlbnQudGFyZ2V0KSA6IG51bGw7XG4gICAgaWYgKHJlYWN0Q29tcG9uZW50ICE9PSB0aGlzLnByZXZpb3VzQ29tcG9uZW50KSB7XG4gICAgICB0aGlzLmNvbXBvbmVudEV2ZW50Q2FjaGUuZm9yRWFjaCgobXNnKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdpbiB0aGUgcmVjb25jaWxlJyk7XG4gICAgICAgIC8vIHRoaXMuc2VuZEV2ZW50KG1zZyk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuY2xlYXJFdmVudENhY2hlKCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIHJlbW92ZSBhbGwgZGl2cyB3aXRoIGEgY2VydGFpbiBjbGFzc25hbWVcbiAgcmVtb3ZlTWVudXNCeUNsYXNzbmFtZSA9IChjbGFzc25hbWU6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IHByZXZpb3VzTWVudXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoY2xhc3NuYW1lKSk7XG4gICAgcHJldmlvdXNNZW51cz8ubWFwKCh2YWw6IGFueSkgPT4gdmFsLnJlbW92ZSgpKTtcbiAgfVxuXG4gIHJlbW92ZVNpbmdsZU1lbnUgPSBhc3luYyAoZWxJRDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgbWVudURpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsSUQpO1xuICAgIG1lbnVEaXY/LnJlbW92ZSgpO1xuICB9O1xuXG4gIHNldHVwTWVudURpdiA9IChtb3VzZUV2ZW50OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgY29uc3QgZXZlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgY29uc3QgZGl2SUQgPSBcImNvbXBvbmVudE1lbnVcIiArIGV2ZW50VGltZTtcbiAgICBjb25zdCBtZW51RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIkRJVlwiKTtcblxuICAgIG1lbnVEaXYuc2V0QXR0cmlidXRlKFwiaWRcIiwgZGl2SUQpO1xuICAgIG1lbnVEaXYuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgJ2NvbXBvbmVudE1lbnUnKTtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1lbnVEaXYpO1xuICAgIG1lbnVEaXYuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG4gICAgbWVudURpdi5zdHlsZS5sZWZ0ID0gbW91c2VFdmVudC54ICsgJ3B4JztcbiAgICBtZW51RGl2LnN0eWxlLnRvcCA9IG1vdXNlRXZlbnQueSArICdweCc7XG4gICAgbWVudURpdi5zdHlsZS56SW5kZXggPSAnOTk5OTk5OTk5OTk5OSc7XG4gICAgcmV0dXJuIGRpdklEXG4gIH1cblxuICBhcHBlbmRCdXR0b24gPSAoZWxJRDpzdHJpbmcgLCBsYWJlbDogc3RyaW5nLCBzdHlsZXM6IGFueSA9IHVuZGVmaW5lZCkgPT4ge1xuICAgIFxuICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJCVVRUT05cIik7XG4gICAgYnRuLnN0eWxlLndpZHRoID0gJzE1MHB4JztcbiAgICBidG4uaW5uZXJIVE1MID0gbGFiZWw7XG5cbiAgICBpZiAoc3R5bGVzKSB7XG4gICAgICBpZiAoc3R5bGVzLmJhY2tncm91bmRDb2xvcikgYnRuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHN0eWxlcy5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxJRCk/LmFwcGVuZENoaWxkKGJ0bik7XG4gICAgY29uc3QgYnIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIik7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxJRCk/LmFwcGVuZENoaWxkKGJyKTtcbiAgICByZXR1cm4gYnRuXG4gIH1cblxuICBjcmVhdGVQb3B1cE1lbnUgPSAobWVzc2FnZTogTWVzc2FnZSwgbW91c2VFdmVudDogTW91c2VFdmVudCkgPT4ge1xuXG4gICAgLy8gcmVtb3ZlIGFsbCBleGlzdGluZyBtZW51c1xuICAgIHRoaXMucmVtb3ZlTWVudXNCeUNsYXNzbmFtZSgnY29tcG9uZW50TWVudScpXG4gICAgLy8gY3JlYXRlIHRoZSBkb20gZWxlbWVudCBhbmQgc3RvcmUgdGhlIGVsZW1lbnQgSURcbiAgICBjb25zdCBkaXZJRCA9IHRoaXMuc2V0dXBNZW51RGl2KG1vdXNlRXZlbnQpICAgIFxuXG4gICAgbWVzc2FnZT8uY29tcG9uZW50SW5mbz8ubWFwKCh2YWw6IGFueSkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJidXR0b24gdmFsOiBcIiwgdmFsKTtcbiAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJCVVRUT05cIik7XG4gICAgICBidG4uc3R5bGUud2lkdGggPSAnMTUwcHgnO1xuICAgICAgYnRuLmlubmVySFRNTCA9IHZhbD8uY29tcG9uZW50TmFtZTtcbiAgICAgIGlmIChidG4uaW5uZXJIVE1MKSB7XG4gICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChldmVudCkgPT4gYXdhaXQgdGhpcy5jb21wb25lbnRNZW51Q2xpY2soZXZlbnQsIGRpdklELCBtZXNzYWdlKSk7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRpdklEKT8uYXBwZW5kQ2hpbGQoYnRuKTtcbiAgICAgICAgY29uc3QgYnIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnJcIik7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRpdklEKT8uYXBwZW5kQ2hpbGQoYnIpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNvbnN0IENhbmNlbEJ0biA9IHRoaXMuYXBwZW5kQnV0dG9uKGRpdklELCAnQ2FuY2VsJylcbiAgICBDYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnJlbW92ZVNpbmdsZU1lbnUoZGl2SUQpKTtcblxuICB9O1xuXG4gIGNyZWF0ZUV4aXN0aW5nVGVzdE1lbnUgPSBhc3luYyAoZXZlbnQ6IGFueSwgZXhpc3RpbmdUZXN0UmVzcG9uc2U6IGFueSkgPT4ge1xuICAgXG4gICAgY29uc3QgZXhpc3RpbmdUZXN0RGl2SUQgPSB0aGlzLnNldHVwTWVudURpdihldmVudCkgIFxuICAgIGNvbnN0IHRlc3QgPSBbXCJhXCIsXCJiXCJdXG5cbiAgICBjb25zdCBkZXNjcmliZUJsb2NrcyA9IGV4aXN0aW5nVGVzdFJlc3BvbnNlLmRlc2NyaWJlQmxvY2tzO1xuXG4gICAgZGVzY3JpYmVCbG9ja3M/Lm1hcCggKHZhbDogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiQlVUVE9OXCIpO1xuICAgICAgYnRuLnN0eWxlLndpZHRoID0gJzE1MHB4JztcbiAgICAgIGJ0bi5pbm5lckhUTUwgPSB2YWw7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChleGlzdGluZ1Rlc3REaXZJRCk/LmFwcGVuZENoaWxkKGJ0bik7XG4gICAgICBjb25zdCBiciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGV4aXN0aW5nVGVzdERpdklEKT8uYXBwZW5kQ2hpbGQoYnIpO1xuICAgIH0pXG4gICAgY29uc3QgbmV3VGVzdEJ0biA9IHRoaXMuYXBwZW5kQnV0dG9uKGV4aXN0aW5nVGVzdERpdklELCAnQ3JlYXRlIE5ldyBUZXN0JylcblxuICAgIGNvbnN0IGNhbmNlbEJ0biA9IHRoaXMuYXBwZW5kQnV0dG9uKGV4aXN0aW5nVGVzdERpdklELCAnQ2FuY2VsJywge2JhY2tncm91bmRDb2xvcjogJyNkZjJhMmE3YSd9KVxuICAgIGNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IGF3YWl0IHRoaXMucmVtb3ZlU2luZ2xlTWVudShleGlzdGluZ1Rlc3REaXZJRCkpO1xuXG4gICAgcmV0dXJuIHtuZXdUZXN0QnRuOiBuZXdUZXN0QnRuLCBleGlzdGluZ1Rlc3RNZW51SUQ6IGV4aXN0aW5nVGVzdERpdklEfVxuICB9XG5cbiAgY29tcG9uZW50TWVudUNsaWNrID0gYXN5bmMgKGV2ZW50OiBhbnksIGRpdklEOiBhbnksIG1lc3NhZ2U6IE1lc3NhZ2UpOiBQcm9taXNlPGFueT4gPT4ge1xuXG4gICAgYXdhaXQgdGhpcy5yZW1vdmVTaW5nbGVNZW51KGRpdklEKTtcblxuICAgIGNvbnN0IHNlbGVjdGVkQ29tcG9uZW50ID0gbWVzc2FnZS5jb21wb25lbnRJbmZvPy5yZWR1Y2UoXG4gICAgICAoYWNjOiBhbnksIGN1cnI6IGFueSkgPT4ge1xuICAgICAgICBpZiAoY3Vyci5jb21wb25lbnROYW1lID09PSBldmVudC50YXJnZXQ/LmlubmVySFRNTCkge1xuICAgICAgICAgIHJldHVybiB7Li4uY3Vycn07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfVxuICAgICAgfSwgbnVsbCk7XG5cbiAgICBldmVudD8uc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgXG4gICAgLy8gY2hlY2sgZm9yIGV4aXN0aW5nIHRlc3RzXG4gICAgY29uc3QgZXhpc3RpbmdUZXN0UmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNoZWNrRm9yRXhpc3RpbmdUZXN0KHNlbGVjdGVkQ29tcG9uZW50Py5maWxlbmFtZSk7XG4gICAgXG4gICAgLy8gdGhlIHJlc3BvbnNlIHdpbGwgY29udGFpbiB0aGUgZG9tIGVsZW1lbnRzIG9mIHRoZSBidXR0b25zIGZvciBlaXRoZXIgdGhlIGV4aXN0aW5nIHRlc3RzIG9yXG4gICAgLy8gdG8gY3JlYXRlIGEgbmV3IHRlc3RcbiAgICBjb25zdCBleGlzdGluZ1Rlc3RNZW51UmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNyZWF0ZUV4aXN0aW5nVGVzdE1lbnUoZXZlbnQsIGV4aXN0aW5nVGVzdFJlc3BvbnNlKVxuXG4gICAgLy8gYWRkIGxpc3RlbmVyIGZvciBjcmVhdGluZyBhIGJyYW5kIG5ldyB0ZXN0XG4gICAgZXhpc3RpbmdUZXN0TWVudVJlc3BvbnNlLm5ld1Rlc3RCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCB0aGlzLmNyZWF0ZU5ld1Rlc3Qoe1xuICAgICAgICAuLi5tZXNzYWdlLFxuICAgICAgICBjb21wb25lbnRJbmZvOiBzZWxlY3RlZENvbXBvbmVudCxcbiAgICAgICAgY2hlY2tlZEV2ZW50OiBleGlzdGluZ1Rlc3RSZXNwb25zZS5jaGVja2VkRXZlbnRcbiAgICAgIH0pXG4gICAgICBhd2FpdCB0aGlzLnJlbW92ZVNpbmdsZU1lbnUoZXhpc3RpbmdUZXN0TWVudVJlc3BvbnNlLmV4aXN0aW5nVGVzdE1lbnVJRCk7XG4gICAgfSk7XG5cbiAgICAvLyB0aGlzLnNlbmRFdmVudCh7XG4gICAgLy8gICAuLi5tZXNzYWdlLFxuICAgIC8vICAgLy8gdGhlcmUgc2hvdWxkIG9ubHkgYmUgb25lIG1hdGNoIGhlcmUgb24gdGhlIGZpbHRlclxuICAgIC8vICAgLy8gY29tcG9uZW50SW5mbzogbWVzc2FnZS5jb21wb25lbnRJbmZvPy5maWx0ZXIoICh2YWw6YW55KSA9PiB2YWwuY29tcG9uZW50TmFtZSA9PT0gZXZlbnQudGFyZ2V0Py5pbm5lckhUTUwpXG4gICAgLy8gICBjb21wb25lbnRJbmZvOiBzZWxlY3RlZENvbXBvbmVudFxuICAgIC8vIH0pLnRoZW4ocmVzID0+IHtjb25zb2xlLmxvZygnZG90IHRoZW4nLCByZXMpfSk7XG5cblxuICB9O1xuXG5cblxuICBnZXRNZXNzYWdlID0gKHJlYWN0Q29tcG9uZW50OiBhbnksIGV2ZW50OiBLZXlib2FyZEV2ZW50IHwgRXZlbnQpOiBNZXNzYWdlID0+IHtcblxuICAgIC8vIGZ1bmN0aW9uIHRvIHVzZSBpbiBhcnJheSByZWR1Y2VcbiAgICBjb25zdCBmaW5kQ2xpY2tIYW5kbGVyID0gKGFjY3VtdWxhdG9yOiBhbnksIGN1cnJlbnRWYWx1ZTogYW55KSA9PiB7XG4gICAgICBpZiAoY3VycmVudFZhbHVlLnByb3BzPy5vbkNsaWNrKSB7XG4gICAgICAgIHJldHVybiB7Li4uY3VycmVudFZhbHVlfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IHx8IGV2ZW50LnNyY0VsZW1lbnQ7XG4gICAgY29uc3QgaW5wdXRUYXJnZXQgPSB0YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICBjb25zdCBsaW5rVGFyZ2V0ID0gdGFyZ2V0IGFzIEhUTUxMaW5rRWxlbWVudDtcblxuICAgIGNvbnN0IGNvbXBvbmVudEluZm8gPSBnZXRDb21wb25lbnRJbmZvKHJlYWN0Q29tcG9uZW50LCAxMCwgW10pO1xuXG4gICAgLy8gZmluZCB0aGUgY2xvc2VzdCBjbGljayBoYW5kbGVyIHRoYXQgd291bGQgaGF2ZSBiZWVuIHRyaWdnZXJlZFxuICAgIC8vIG5vdGUsIHNsaWNlKDApIGNvcGllcyB0aGUgYXJyYXlcbiAgICBjb25zdCBjbGlja0hhbmRsZXIgPSBjb21wb25lbnRJbmZvPy5zbGljZSgwKT8ucmV2ZXJzZSgpPy5yZWR1Y2UoZmluZENsaWNrSGFuZGxlciwgbnVsbCk7XG5cblxuICAgIC8vIGNvbnNvbGUubG9nKCdjb21wb25lbnQgaW5mbyBpbiBHRVRfTUVTU0FHRTogJywgY29tcG9uZW50SW5mbywgY2xpY2tIYW5kbGVyKVxuXG4gICAgY29uc3QgbWVzc2FnZTogTWVzc2FnZSA9IHtcbiAgICAgIC8vIGNvbXBvbmVudE5hbWUsIGZpbGVOYW1lLCBhbmQgbGluZU51bWJlciBhcmUgYWxyZWFkeSBpbiB0aGUgb2JqZWN0IHJldHVybmVkXG4gICAgICBhY3Rpb246IGV2ZW50LnR5cGUsXG4gICAgICBjaGVja2VkOiBldmVudD8udGFyZ2V0Py5oYXNPd25Qcm9wZXJ0eShcImNoZWNrZWRcIilcbiAgICAgICAgPyBpbnB1dFRhcmdldC5jaGVja2VkXG4gICAgICAgIDogbnVsbCxcbiAgICAgIGNvb3JkaW5hdGVzOiBnZXRDb29yZGluYXRlcyhldmVudCksXG4gICAgICBocmVmOiBsaW5rVGFyZ2V0LmhyZWYgPyBsaW5rVGFyZ2V0LmhyZWYgOiBudWxsLFxuICAgICAga2V5Q29kZTogKGV2ZW50IGFzIEtleWJvYXJkRXZlbnQpLmtleUNvZGVcbiAgICAgICAgPyAoZXZlbnQgYXMgS2V5Ym9hcmRFdmVudCkua2V5Q29kZVxuICAgICAgICA6IG51bGwsXG4gICAgICB0YWdOYW1lOiBpbnB1dFRhcmdldC50YWdOYW1lLFxuICAgICAgdGFnVHlwZTogaW5wdXRUYXJnZXQudHlwZSxcbiAgICAgIHRleHRDb250ZW50OiBpbnB1dFRhcmdldC50ZXh0Q29udGVudCB8fCBpbnB1dFRhcmdldC5pbm5lclRleHQsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxuICAgICAgdmFsdWU6IGlucHV0VGFyZ2V0LnZhbHVlLFxuICAgICAgd3JpdGVUZXN0TG9jYXRpb246ICcnLFxuICAgICAgY29tcG9uZW50SW5mbzogY29tcG9uZW50SW5mbyxcbiAgICAgIGNsaWNrSGFuZGxlckNvbXBvbmVudDogY2xpY2tIYW5kbGVyLFxuICAgICAgY2hlY2tlZEV2ZW50OiB1bmRlZmluZWRcblxuICAgIH07XG5cbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfTtcblxuXG4gIHJlY29yZEV2ZW50ID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuICAgIGNvbnN0IG5vZGVUYXJnZXQgPSBldmVudC50YXJnZXQgYXMgTm9kZTtcbiAgICBjb25zdCBtb3VzZUV2ZW50ID0gZXZlbnQgYXMgTW91c2VFdmVudDtcblxuICAgIC8vIGlmIHRoZSBjbGljayBpcyBvbiBhIG1lbnUgdGhhdCBwb3BzIHVwLCBkb250IGdvIHRocm91Z2ggdGhlIHJlY29yZCBldmVudCBsb2dpY1xuICAgIGlmIChub2RlVGFyZ2V0Py5wYXJlbnRFbGVtZW50Py5nZXRBdHRyaWJ1dGUoXCJpZFwiKT8uaW5jbHVkZXMoJ2NvbXBvbmVudE1lbnUnKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIWV2ZW50LnRhcmdldCkgcmV0dXJuO1xuXG4gICAgdHJ5IHtcbiAgICAgIGlmICh0aGlzLnByZXZpb3VzTXNnKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAoZXZlbnQudHlwZSA9PT0gXCJjaGFuZ2VcIiB8fCBldmVudC50eXBlID09PSBcImNsaWNrXCIpICYmXG4gICAgICAgICAgdGhpcy5wcmV2aW91c01zZyAmJlxuICAgICAgICAgIHRoaXMucHJldmlvdXNNc2cuYWN0aW9uID09PSBcImNsaWNrXCIgJiZcbiAgICAgICAgICBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHRoaXMucHJldmlvdXNNc2cudGltZXN0YW1wIDwgMTAwXG4gICAgICAgICkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwibWVzc2FnZSBub3Qgc2VuZCBkdWUgdG8gdGltZVwiKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVhY3RDb21wb25lbnQgPSBmaW5kUmVhY3RFbGVtZW50KGV2ZW50LnRhcmdldCk7XG4gICAgICBjb25zdCBtc2c6IE1lc3NhZ2UgPSB0aGlzLmdldE1lc3NhZ2UocmVhY3RDb21wb25lbnQsIGV2ZW50KTtcbiAgICAgIGNvbnNvbGUubG9nKCdyZWFjdENvbXBvbmVudCBhbmQgbWVzc2FnZSBpbiBSRUNPUkRfRVZFTlQ6ICcsIHJlYWN0Q29tcG9uZW50LCBtc2cpO1xuXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImxhc3RFdmVudFwiLCBKU09OLnN0cmluZ2lmeShtc2cpKTtcbiAgICAgIHRoaXMucHJldmlvdXNNc2cgPSBtc2c7XG5cbiAgICAgIC8vIGlmIChcbiAgICAgIC8vICAgLy8gaWYgdGhlcmUgaXMgbm8gcHJldmlvdXMgY29tcG9uZW50IG9yIHRoZSBwcmV2aW91cyBjb21wb25lbnQgaXMgdGhlIHNhbWUgYXMgdGhlIGNvbXBvbmVudCB5b3UganVzdCBjbGlja2VkIG9uXG4gICAgICAvLyAgICF0aGlzLnByZXZpb3VzQ29tcG9uZW50IHx8XG4gICAgICAvLyAgICh0aGlzLnByZXZpb3VzQ29tcG9uZW50ICYmIHRoaXMucHJldmlvdXNDb21wb25lbnQgPT09IHJlYWN0Q29tcG9uZW50KVxuICAgICAgLy8gKSB7XG4gICAgICAvLyAgIHRoaXMucHJldmlvdXNDb21wb25lbnQgPSByZWFjdENvbXBvbmVudDtcbiAgICAgIC8vICAgaWYgKFxuICAgICAgLy8gICAgIHRoaXMucHJldmlvdXNDb21wb25lbnQgJiZcbiAgICAgIC8vICAgICBtc2cuY2hlY2tlZCAhPT0gbnVsbCAmJlxuICAgICAgLy8gICAgIG1zZy5hY3Rpb24gPT09IFwiY2xpY2tcIlxuICAgICAgLy8gICApIHtcbiAgICAgIC8vICAgICAvLyBtZXNzYWdlIGlzIHNlbnQgd2hlbiBzb21ldGhpbmcgaW4gdGhlIHBvcHVwIG1lbnUgaXMgc2VsZWN0ZWRcbiAgICAgIC8vICAgICB0aGlzLmNyZWF0ZVBvcHVwTWVudShtc2cpO1xuICAgICAgLy8gICAgIC8vIHRoaXMuc2VuZEV2ZW50KG1zZyk7XG4gICAgICAvLyAgICAgcmV0dXJuO1xuICAgICAgLy8gICB9XG5cbiAgICAgIC8vICAgLy9wdXNoaW5nIGEgbWVzc2FnZSB0byB0aGUgZXZlbnQgY2FjaGUgc2VuZHMgaXQgdG8gdGhlIGFwaSB3aGVuIHRoZSByZWNvbmNpbGUgY2FsbGJhY2sgaXMgY2FsbGVkXG4gICAgICAvLyAgIHRoaXMuY29tcG9uZW50RXZlbnRDYWNoZS5wdXNoKG1zZyk7XG5cbiAgICAgIC8vICAgcmV0dXJuO1xuICAgICAgLy8gfSBlbHNlIHtcbiAgICAgIC8vICAgdGhpcy5jbGVhckV2ZW50Q2FjaGUoKTtcbiAgICAgIC8vIH1cblxuICAgICAgdGhpcy5wcmV2aW91c0NvbXBvbmVudCA9IHJlYWN0Q29tcG9uZW50O1xuXG4gICAgICAvLyBtZXNzYWdlIGlzIHNlbnQgd2hlbiBzb21ldGhpbmcgaW4gdGhlIHBvcHVwIG1lbnUgaXMgc2VsZWN0ZWRcbiAgICAgIGlmIChtb3VzZUV2ZW50Py5tZXRhS2V5KSB0aGlzLmNyZWF0ZVBvcHVwTWVudShtc2csIG1vdXNlRXZlbnQpO1xuICAgICAgLy8gdGhpcy5zZW5kRXZlbnQobXNnKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcmVjb3JkaW5nIGV2ZW50XCIsIGUpO1xuICAgIH1cbiAgfTtcblxuICBjcmVhdGVOZXdUZXN0ID0gYXN5bmMgKG1lc3NhZ2U6IE1lc3NhZ2UpID0+IHtcbiAgICBsZXQgYWNjb3VudElkID0gKHdpbmRvdyBhcyB7IFtrZXk6IHN0cmluZ106IGFueSB9KVtcImRhdGFMYXllclwiXVswXVtcImFwaUtleVwiXTtcblxuICAgIGNvbnNvbGUubG9nKCdtZXNzYWdlOiAnLCBtZXNzYWdlICk7XG5cbiAgICAvLyByYXRoZXIgZ2V0IGEgNDAzIHRoYW4gYSBiYWQgcm91dGVcbiAgICBpZiAoIWFjY291bnRJZCkge1xuICAgICAgYWNjb3VudElkID0gMTtcbiAgICB9XG5cbiAgICBjb25zdCB1cmwgPSBgLy9sb2NhbGhvc3Q6MzAyMC9hcGkvYWNjb3VudHMvJHthY2NvdW50SWR9L2V2ZW50cy9gO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBtb2RlOiBcImNvcnNcIixcbiAgICAgIGNhY2hlOiBcIm5vLWNhY2hlXCIsXG4gICAgICBjcmVkZW50aWFsczogXCJzYW1lLW9yaWdpblwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHVybDogd2luZG93LmxvY2F0aW9uLmhyZWYsXG4gICAgICAgIGV2ZW50OiBtZXNzYWdlLFxuICAgICAgICAvLyBUT0RPOiB0ZXN0IHNldCBpZCBzaG91bGQgYmUgc2V0IHdoZW4gY3JlYXRpbmcvbG9hZGluZyB0ZXN0c2V0IGluIHRoZSBydW5uZXJcbiAgICAgICAgcGxhY2Vob2xkZXI6IG51bGwsXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIHJldHVybiByZXNwb25zZS5qc29uKClcbiAgfTtcblxuICBjaGVja0ZvckV4aXN0aW5nVGVzdCA9IGFzeW5jIChmaWxlcGF0aDogc3RyaW5nKSA9PiB7XG4gICAgbGV0IGFjY291bnRJZCA9ICh3aW5kb3cgYXMgeyBba2V5OiBzdHJpbmddOiBhbnkgfSlbXCJkYXRhTGF5ZXJcIl1bMF1bXCJhcGlLZXlcIl07XG5cbiAgICAvLyByYXRoZXIgZ2V0IGEgNDAzIHRoYW4gYSBiYWQgcm91dGVcbiAgICBpZiAoIWFjY291bnRJZCkge1xuICAgICAgYWNjb3VudElkID0gMTtcbiAgICB9XG5cbiAgICBjb25zdCB1cmlGaWxlcGF0aCA9IGVuY29kZVVSSShmaWxlcGF0aClcbiAgICBjb25zdCB1cmwgPSBgLy9sb2NhbGhvc3Q6MzAyMC9hcGkvYWNjb3VudHMvJHthY2NvdW50SWR9L2V2ZW50cy8/ZmlsZXBhdGg9JHt1cmlGaWxlcGF0aH1gO1xuXG4gICAgY29uc29sZS5sb2coJ3VybCBoaXQ6ICcsIHVybCwgdXJpRmlsZXBhdGgpXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIG1vZGU6IFwiY29yc1wiLFxuICAgICAgY2FjaGU6IFwibm8tY2FjaGVcIixcbiAgICAgIGNyZWRlbnRpYWxzOiBcInNhbWUtb3JpZ2luXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKVxuICB9O1xufVxuXG4oPGFueT53aW5kb3cpLmV2ZW50UmVjb3JkZXIgPSBuZXcgQXNzZXJ0bHlDbGllbnQoKTtcbig8YW55PndpbmRvdykuZXZlbnRSZWNvcmRlci5zdGFydCgpO1xuXG4iLCJpbXBvcnQgQ29vcmRpbmF0ZXMgZnJvbSBcIi4vdHlwZXMvQ29vcmRpbmF0ZXNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbXBvbmVudEluZm8oY29tcG9uZW50OiBhbnksIG1heE5lc3Q6IG51bWJlciwgcmVzdWx0QXJyYXk6IGFueSk6IGFueSB7XG4gIGNvbnNvbGUubG9nKCdnZXRDb21wb25lbnRJbmZvOiAnLCBjb21wb25lbnQsIHJlc3VsdEFycmF5KVxuXG4gIGlmICghY29tcG9uZW50IHx8IG1heE5lc3QgPT09IDApIHtcbiAgICAvLyBjb25zb2xlLmxvZygncmVzdWx0QXJyYXk6ICcsIHJlc3VsdEFycmF5KVxuICAgIHJldHVybiByZXN1bHRBcnJheVxuICB9XG5cbiAgaWYgKGNvbXBvbmVudD8uX2RlYnVnU291cmNlPy5maWxlTmFtZSkge1xuICAgIC8vIHRoZSBvd25lciBvZiB0aGUgbm9kZSB3aGVyZSB0aGUgJ3NvdXJjZScgZmlsZW5hbWUgZXhpc3RzIGlzIHRoZSBmaWxlIHRoYXQgeW91IHdhbnQgdGhlIHByb3BzIGZvciBcbiAgICBjb25zdCBwcm9wcyA9IGdldENvbXBvbmVudFByb3BzKGNvbXBvbmVudD8uX2RlYnVnT3duZXIpXG4gICAgY29uc3QgbmFtZSA9IGdldENvbXBvbmVudE5hbWUoY29tcG9uZW50Py5fZGVidWdPd25lcilcbiAgICByZXN1bHRBcnJheS5wdXNoKHtcbiAgICAgIGZpbGVuYW1lOiBjb21wb25lbnQ/Ll9kZWJ1Z1NvdXJjZT8uZmlsZU5hbWUsIFxuICAgICAgLy8gdGhlIGxpbmUgbnVtYmVyIGlzIHJlYWxseSBmb3IgdGhlIG5leHQgY29tcG9uZW50IGRvd24gaW4gdGhlIHRyZWUgdGhhdCBpcyBiZWluZyBjYWxsZWQgZnJvbSB0aGUgJ2ZpbGVuYW1lJ1xuICAgICAgbGluZW51bWJlcjogY29tcG9uZW50Py5fZGVidWdTb3VyY2U/LmxpbmVOdW1iZXIsIFxuICAgICAgcHJvcHM6IHByb3BzLCBcbiAgICAgIC8vIGlmIGl0J3MgY29tcG9uZW50ICBzdHIuc3BsaXQoJ1xcXFwnKS5wb3Auc3BsaXQoYC9gKS5wb3AoKS5zcGxpdCgnLicpWzBdXG4gICAgICBjb21wb25lbnROYW1lOiBuYW1lID09PSAnQ29tcG9uZW50JyA/IFxuICAgICAgICBjb21wb25lbnQ/Ll9kZWJ1Z1NvdXJjZT8uZmlsZU5hbWU/LnNwbGl0KCdcXFxcJykucG9wKCkuc3BsaXQoYC9gKS5wb3AoKS5zcGxpdCgnLicpWzBdIDogbmFtZVxuICAgIH0pXG4gICAgcmV0dXJuIGdldENvbXBvbmVudEluZm8oY29tcG9uZW50Py5fZGVidWdPd25lcixtYXhOZXN0LTEscmVzdWx0QXJyYXkpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGdldENvbXBvbmVudEluZm8oY29tcG9uZW50Py5fZGVidWdPd25lcixtYXhOZXN0LTEscmVzdWx0QXJyYXkpXG4gIH1cblxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29tcG9uZW50UHJvcHMoY29tcG9uZW50OiBhbnksIHByb3BzID0ge30pOiBhbnkge1xuICBpZiAoIWNvbXBvbmVudCkge1xuICAgIGZ1bmN0aW9uU3RyaW5naWZ5KHByb3BzKTtcbiAgICByZXR1cm4gcHJvcHM7XG4gIH1cblxuICBjb25zdCBuZXdQcm9wcyA9IGNvbXBvbmVudC5wZW5kaW5nUHJvcHNcbiAgICA/IHsgLi4ucHJvcHMsIC4uLmNvbXBvbmVudC5wZW5kaW5nUHJvcHMgfVxuICAgIDogcHJvcHM7XG4gIGRlbGV0ZSBuZXdQcm9wcy5jaGlsZHJlbjtcblxuICBpZiAoXG4gICAgY29tcG9uZW50Py50eXBlPy5fX3Byb3RvX18gJiZcbiAgICBbXCJDb21wb25lbnRcIiwgXCJQdXJlQ29tcG9uZW50XCJdLmluY2x1ZGVzKGNvbXBvbmVudC50eXBlLl9fcHJvdG9fXy5uYW1lKVxuICApIHtcbiAgICBmdW5jdGlvblN0cmluZ2lmeShuZXdQcm9wcyk7XG4gICAgcmV0dXJuIG5ld1Byb3BzO1xuICB9XG5cbiAgcmV0dXJuIGdldENvbXBvbmVudFByb3BzKGNvbXBvbmVudC5fZGVidWdPd25lciwgbmV3UHJvcHMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29tcG9uZW50TmFtZShmaWJlcjogYW55KTogYW55IHtcbiAgaWYgKCFmaWJlcikgcmV0dXJuIG51bGw7XG5cbiAgaWYgKGZpYmVyLmVsZW1lbnRUeXBlICYmIGZpYmVyLmVsZW1lbnRUeXBlLm5hbWUpIHtcbiAgICByZXR1cm4gZmliZXIuZWxlbWVudFR5cGUubmFtZTtcbiAgfVxuXG4gIGlmIChmaWJlci5lbGVtZW50VHlwZSAmJiBmaWJlci5lbGVtZW50VHlwZS5kaXNwbGF5TmFtZSkge1xuICAgIHJldHVybiBmaWJlci5lbGVtZW50VHlwZS5kaXNwbGF5TmFtZTtcbiAgfVxuXG4gIGlmIChmaWJlci50eXBlLmRpc3BsYXlOYW1lKSB7XG4gICAgcmV0dXJuIGZpYmVyLnR5cGUuZGlzcGxheU5hbWU7XG4gIH1cblxuICBpZiAoZmliZXIudHlwZS5uYW1lKSB7XG4gICAgcmV0dXJuIGZpYmVyLnR5cGUubmFtZTtcbiAgfVxuICByZXR1cm4gZ2V0Q29tcG9uZW50TmFtZShmaWJlci5fZGVidWdPd25lcik7XG59XG5cbmNvbnN0IGV2ZW50c1dpdGhDb29yZGluYXRlczogeyBba2V5OiBzdHJpbmddOiBhbnkgfSA9IHtcbiAgbW91c2V1cDogdHJ1ZSxcbiAgbW91c2Vkb3duOiB0cnVlLFxuICBtb3VzZW1vdmU6IHRydWUsXG4gIG1vdXNlb3ZlcjogdHJ1ZSxcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb29yZGluYXRlcyhldmVudDogRXZlbnQpOiBDb29yZGluYXRlcyB8IG51bGwge1xuICBjb25zdCBtb3VzZUV2ZW50ID0gZXZlbnQgYXMgTW91c2VFdmVudDtcblxuICByZXR1cm4gZXZlbnRzV2l0aENvb3JkaW5hdGVzW2V2ZW50LnR5cGVdXG4gICAgPyB7IHg6IG1vdXNlRXZlbnQuY2xpZW50WCwgeTogbW91c2VFdmVudC5jbGllbnRZIH1cbiAgICA6IG51bGw7XG59XG5cbi8vIG1hcCByZWFjdCBjbGFzc2VzIHRvIGRvbSBlbGVtZW50c1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRSZWFjdEVsZW1lbnREVVJLQSh0YXJnZXQ6IEV2ZW50VGFyZ2V0KTogYW55IHtcbiAgLy8gY29uc29sZS5kaXIodGFyZ2V0KVxuICBjb25zdCBrZXkgPSBPYmplY3Qua2V5cyh0YXJnZXQpLmZpbmQoKGtleSkgPT5cbiAgICBrZXkuc3RhcnRzV2l0aChcIl9fcmVhY3RJbnRlcm5hbEluc3RhbmNlJFwiKVxuICApO1xuICAvLyBjb25zb2xlLmxvZygna2V5OiAnLCBrZXkpXG4gIC8vIGNyZWF0ZXMgYW4gb2JqZWN0IG91dCBvZiB0aGUgdGFyZ2V0IHBhc3NlZFxuICBjb25zdCB0YXJnZXRNYXAgPSB0YXJnZXQgYXMgeyBba2V5OiBzdHJpbmddOiBhbnkgfTtcblxuICBjb25zdCBpbnRlcm5hbEluc3RhbmNlID0ga2V5ID8gdGFyZ2V0TWFwW2tleV0gOiBudWxsO1xuICAvLyBjb25zb2xlLmxvZygnUmVhY3QgTm9kZSBpZiBGb3VuZDogJywgaW50ZXJuYWxJbnN0YW5jZSlcbiAgaWYgKGludGVybmFsSW5zdGFuY2UgPT0gbnVsbCkgcmV0dXJuIG51bGw7XG5cbiAgLy8gY29uc29sZS5sb2coJ2ludGVybmFsSW5zdGFuY2UyOiAnLCBpbnRlcm5hbEluc3RhbmNlKVxuICAvLyByZXR1cm4gaW50ZXJuYWxJbnN0YW5jZS5fZGVidWdPd25lclxuICAvLyAgID8gaW50ZXJuYWxJbnN0YW5jZS5fZGVidWdPd25lci5zdGF0ZU5vZGVcbiAgLy8gICA6IGludGVybmFsSW5zdGFuY2UucmV0dXJuLnN0YXRlTm9kZTtcblxuICByZXR1cm4gaW50ZXJuYWxJbnN0YW5jZTtcblxuICAvLyBmb3IgKGxldCBrZXk6IHN0cmluZyBpbiB0YXJnZXQpIHtcbiAgLy8gICBpZiAoa2V5LnN0YXJ0c1dpdGgoXCJfX3JlYWN0SW50ZXJuYWxJbnN0YW5jZSRcIikpIHtcbiAgLy8gICAgIC8vIGNvbnNvbGUubG9nKCdrZXlzIGluIHRoZSBmaW5kIFJlYWN0RWxlbWVudCcsIHRhcmdldFtrZXldKVxuICAvLyAgICAgcmV0dXJuIHRhcmdldFtrZXldO1xuICAvLyAgIH1cbiAgLy8gfVxuICAvLyByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRSZWFjdEVsZW1lbnQodGFyZ2V0OiBFdmVudFRhcmdldCk6IGFueSB7XG4gIC8vIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKHRhcmdldCkuZmluZCgoa2V5KSA9PlxuICAvLyAgIGtleS5zdGFydHNXaXRoKFwiX19yZWFjdEludGVybmFsSW5zdGFuY2UkXCIpXG4gIC8vICk7XG4gIGNvbnN0IHRhcmdldE1hcCA9IHRhcmdldCBhcyB7IFtrZXk6IHN0cmluZ106IGFueSB9O1xuICAvLyBjb25zdCBpbnRlcm5hbEluc3RhbmNlID0ga2V5ID8gdGFyZ2V0TWFwW2tleV0gOiBudWxsO1xuICAvLyBpZiAoaW50ZXJuYWxJbnN0YW5jZSA9PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgLy8gcmV0dXJuIGludGVybmFsSW5zdGFuY2UuX2RlYnVnT3duZXJcbiAgLy8gICA/IGludGVybmFsSW5zdGFuY2UuX2RlYnVnT3duZXIuc3RhdGVOb2RlXG4gIC8vICAgOiBpbnRlcm5hbEluc3RhbmNlLnJldHVybi5zdGF0ZU5vZGU7XG4gIGZvciAobGV0IGtleSBpbiB0YXJnZXRNYXApIHtcbiAgICBpZiAoa2V5LnN0YXJ0c1dpdGgoXCJfX3JlYWN0SW50ZXJuYWxJbnN0YW5jZSRcIikpIHtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdrZXlzIGluIHRoZSBmaW5kIFJlYWN0RWxlbWVudCcsIHRhcmdldFtrZXldKVxuICAgICAgcmV0dXJuIHRhcmdldE1hcFtrZXldO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gZnVuY3Rpb25TdHJpbmdpZnkob2JqOiBhbnkpOiB2b2lkIHtcbiAgZm9yIChsZXQgayBpbiBvYmopIHtcbiAgICBpZiAob2JqW2tdICYmIHt9LnRvU3RyaW5nLmNhbGwob2JqW2tdKSA9PT0gXCJbb2JqZWN0IEZ1bmN0aW9uXVwiKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBvYmpba10gPSBcIlwiICsgb2JqW2tdO1xuICAgICAgICAvLyAvLyBnZXQgcmlkIG9mIHRoZSBleHRyYSBsaW5lIG1hcmtlcnNcbiAgICAgICAgLy8gb2JqW2tdID0gb2JqW2tdLnJlcGxhY2UoLyhcXHJcXG58XFxufFxccikvZ20sIFwiXCIpO1xuICAgICAgICBvYmpba10gPSBcIltGdW5jdGlvbl1cIlxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc3RyaW5naWZ5aW5nIHByb3BcIiwgZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHN0cmlwRXh0cmFDb21wb25lbnRQcm9wcyhvYmopO1xufVxuXG5cblxuZnVuY3Rpb24gc3RyaXBFeHRyYUNvbXBvbmVudFByb3BzKHByb3BzOiBhbnkpOiB2b2lkIHtcbiAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHByb3BzKTtcbiAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuICAgIGlmIChcbiAgICAgIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChwcm9wc1trZXldKSA9PT0gXCJbb2JqZWN0IE9iamVjdF1cIiAmJlxuICAgICAgKHByb3BzW2tleV0uaGFzT3duUHJvcGVydHkoXCJfb3duZXJcIikgfHxcbiAgICAgICAga2V5ID09PSBcImlucHV0UmVmXCIgfHxcbiAgICAgICAga2V5ID09PSBcIklucHV0UHJvcHNcIilcbiAgICApIHtcbiAgICAgIGRlbGV0ZSBwcm9wc1trZXldO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgRXZlbnRUeXBlLCBSZWNvbmNpbGVUeXBlIH0gZnJvbSBcIi4vdHlwZXMvRXZlbnRUeXBlXCI7XG5pbXBvcnQgeyBSZWNvcmRlckNvbmZpZyB9IGZyb20gXCIuL3R5cGVzL1JlY29yZGVyQ29uZmlnXCI7XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgcmVjb3JkZXJBZGRlZENvbnRyb2xMaXN0ZW5lcnM6IGJvb2xlYW47XG4gICAgZGF0YUxheWVyOiBhbnlbXTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFdmVudFJlY29yZGVyIHtcbiAgcHJpdmF0ZSBldmVudENhbGxiYWNrOiAoZXZlbnQ6IEV2ZW50KSA9PiBhbnk7XG4gIHByaXZhdGUgcmVjb25jaWxlQ2FsbGJhY2s6IChldmVudDogRXZlbnQpID0+IGFueTtcbiAgcHJpdmF0ZSByZWNvcmRFdmVudHM6IEV2ZW50VHlwZVtdID0gW107XG4gIHByaXZhdGUgcmVjb25jaWxlRXZlbnRzOiBSZWNvbmNpbGVUeXBlW10gPSBbXCJibHVyXCIsIFwiZm9jdXNcIiwgXCJjaGFuZ2VcIl07XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBSZWNvcmRlckNvbmZpZykge1xuICAgIGNvbnN0IHtcbiAgICAgIGV2ZW50Q2FsbGJhY2ssXG4gICAgICByZWNvbmNpbGVDYWxsYmFjayxcbiAgICAgIHJlY29yZEV2ZW50cyxcbiAgICAgIHJlY29uY2lsZUV2ZW50cyA9IG51bGwsXG4gICAgfSA9IGNvbmZpZztcbiAgICB0aGlzLmV2ZW50Q2FsbGJhY2sgPSBldmVudENhbGxiYWNrO1xuICAgIHRoaXMucmVjb25jaWxlQ2FsbGJhY2sgPSByZWNvbmNpbGVDYWxsYmFjaztcbiAgICB0aGlzLnJlY29yZEV2ZW50cyA9IHJlY29yZEV2ZW50cztcbiAgICBpZiAocmVjb25jaWxlRXZlbnRzKSB7XG4gICAgICB0aGlzLnJlY29uY2lsZUV2ZW50cyA9IHJlY29uY2lsZUV2ZW50cztcbiAgICB9XG4gIH1cblxuICBhZGRBbGxMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgdGhpcy5yZWNvcmRFdmVudHMuZm9yRWFjaCgoZXZlbnQpID0+IHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCB0aGlzLmV2ZW50Q2FsbGJhY2ssIHRydWUpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5yZWNvbmNpbGVFdmVudHMuZm9yRWFjaCgoZXZlbnQpID0+IHtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCB0aGlzLnJlY29uY2lsZUNhbGxiYWNrLCB0cnVlKTtcbiAgICB9KTtcbiAgfTtcblxuICByZW1vdmVBbGxMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgdGhpcy5yZWNvcmRFdmVudHMuZm9yRWFjaCgoZXZlbnQpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCB0aGlzLmV2ZW50Q2FsbGJhY2ssIHRydWUpO1xuICAgIH0pO1xuICAgIHRoaXMucmVjb25jaWxlRXZlbnRzLmZvckVhY2goKGV2ZW50OiBSZWNvbmNpbGVUeXBlKSA9PiB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5yZWNvbmNpbGVDYWxsYmFjaywgdHJ1ZSk7XG4gICAgfSk7XG4gIH07XG5cbiAgc3RhcnQgPSAoKSA9PiB7XG4gICAgaWYgKCF3aW5kb3cucmVjb3JkZXJBZGRlZENvbnRyb2xMaXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMuYWRkQWxsTGlzdGVuZXJzKCk7XG4gICAgICB3aW5kb3cucmVjb3JkZXJBZGRlZENvbnRyb2xMaXN0ZW5lcnMgPSB0cnVlO1xuICAgIH1cbiAgfTtcblxuICBzdG9wID0gKCkgPT4ge1xuICAgIGlmICh3aW5kb3cucmVjb3JkZXJBZGRlZENvbnRyb2xMaXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICB3aW5kb3cucmVjb3JkZXJBZGRlZENvbnRyb2xMaXN0ZW5lcnMgPSBmYWxzZTtcbiAgICB9XG4gIH07XG59XG4iXSwic291cmNlUm9vdCI6IiJ9