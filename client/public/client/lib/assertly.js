!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function l(e){try{u(o.next(e))}catch(e){i(e)}}function c(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,c)}u((o=o.apply(e,n||[])).next())}))},i=this&&this.__generator||function(e,n){var t,o,r,i,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(r=l.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){l.label=i[1];break}if(6===i[0]&&l.label<r[1]){l.label=r[1],r=i;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(i);break}r[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=t(1),u=l(t(2)),a=function(){var e=this;this.eventsToRecord=["click","change"],this.componentEventCache=[],this.previousComponent=null,this.previousMsg=null,this.start=function(){e.eventRecorder.start()},this.stop=function(){e.eventRecorder.stop()},this.clearEventCache=function(){e.componentEventCache=[]},this.reconcileEventCache=function(n){(n.target?c.findReactElement(n.target):null)!==e.previousComponent&&(e.componentEventCache.forEach((function(n){console.log("in the reconcile"),e.sendEvent(n)})),e.clearEventCache())},this.createPopupMenu=function(n){var t,o="componentMenu"+(new Date).getTime(),r=event,i=document.createElement("DIV"),l=Array.from(document.getElementsByClassName("componentMenu"));null==l||l.map((function(e){return e.remove()})),i.setAttribute("id",o),i.setAttribute("class","componentMenu"),document.body.appendChild(i),i.style.position="absolute",i.style.left=r.x+"px",i.style.top=r.y+"px",i.style.zIndex="9999999999999",null===(t=null==n?void 0:n.componentInfo)||void 0===t||t.map((function(t){console.log("button val: ",t);var r=document.createElement("BUTTON");if(r.style.width="150px",r.innerHTML=null==t?void 0:t.componentName,r.innerHTML){r.addEventListener("click",(function(){return e.componentMenuClick(event,o,n)})),i.appendChild(r);var l=document.createElement("br");i.appendChild(l)}}));var c=document.createElement("BUTTON");c.style.width="150px",c.innerHTML="Cancel",c.addEventListener("click",(function(){return e.removeSingleMenu(o)})),i.appendChild(c)},this.removeSingleMenu=function(e){var n=document.getElementById(e);null==n||n.remove()},this.componentMenuClick=function(n,t,r){var i,l=null===(i=r.componentInfo)||void 0===i?void 0:i.reduce((function(e,t){var r;return t.componentName===(null===(r=n.target)||void 0===r?void 0:r.innerHTML)?o({},t):e}),null);null==n||n.stopPropagation(),e.sendEvent(o(o({},r),{componentInfo:l})).then((function(e){console.log("dot then",e)})),e.removeSingleMenu(t)},this.getMessage=function(e,n){var t,r,i,l=n.target||n.srcElement,u=l,a=l,s=c.getComponentInfo(e,10,[]),d=null===(r=null===(t=null==s?void 0:s.slice(0))||void 0===t?void 0:t.reverse())||void 0===r?void 0:r.reduce((function(e,n){var t;return(null===(t=n.props)||void 0===t?void 0:t.onClick)?o({},n):e}),null);return{action:n.type,checked:(null===(i=null==n?void 0:n.target)||void 0===i?void 0:i.hasOwnProperty("checked"))?u.checked:null,coordinates:c.getCoordinates(n),href:a.href?a.href:null,keyCode:n.keyCode?n.keyCode:null,tagName:u.tagName,tagType:u.type,textContent:u.textContent||u.innerText,timestamp:(new Date).getTime(),value:u.value,writeTestLocation:"",componentInfo:s,clickHandlerComponent:d}},this.recordEvent=function(n){var t,o,r=n.target,i=n;if(!(null===(o=null===(t=null==r?void 0:r.parentElement)||void 0===t?void 0:t.getAttribute("id"))||void 0===o?void 0:o.includes("componentMenu"))&&n.target)try{if(e.previousMsg&&("change"===n.type||"click"===n.type)&&e.previousMsg&&"click"===e.previousMsg.action&&(new Date).getTime()-e.previousMsg.timestamp<100)return void console.log("message not send due to time");var l=c.findReactElement(n.target),u=e.getMessage(l,n);console.log("reactComponent and message in RECORD_EVENT: ",l,u),localStorage.setItem("lastEvent",JSON.stringify(u)),e.previousMsg=u,e.previousComponent=l,(null==i?void 0:i.metaKey)&&e.createPopupMenu(u)}catch(e){console.error("Error recording event",e)}},this.sendEvent=function(n){return r(e,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return(e=window.dataLayer[0].apiKey)||(e=1),[4,fetch("//localhost:3020/api/accounts/"+e+"/events/",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:window.location.href,event:n,placeholder:null})})];case 1:return[2,t.sent().json()]}}))}))},this.eventRecorder=new u.default({recordEvents:this.eventsToRecord,eventCallback:this.recordEvent,reconcileCallback:this.reconcileEventCache})};n.default=a,window.eventRecorder=new a,window.eventRecorder.start()},function(e,n,t){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function r(e,n){var t;if(void 0===n&&(n={}),!e)return c(n),n;var i=e.pendingProps?o(o({},n),e.pendingProps):n;return delete i.children,(null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.__proto__)&&["Component","PureComponent"].includes(e.type.__proto__.name)?(c(i),i):r(e._debugOwner,i)}function i(e){return e?e.elementType&&e.elementType.name?e.elementType.name:e.elementType&&e.elementType.displayName?e.elementType.displayName:e.type.displayName?e.type.displayName:e.type.name?e.type.name:i(e._debugOwner):null}Object.defineProperty(n,"__esModule",{value:!0}),n.functionStringify=n.findReactElement=n.findReactElementDURKA=n.getCoordinates=n.getComponentName=n.getComponentProps=n.getComponentInfo=void 0,n.getComponentInfo=function e(n,t,o){var l,c,u,a,s;if(console.log("getComponentInfo: ",n,o),!n||0===t)return o;if(null===(l=null==n?void 0:n._debugSource)||void 0===l?void 0:l.fileName){var d=r(null==n?void 0:n._debugOwner),v=i(null==n?void 0:n._debugOwner);return o.push({filename:null===(c=null==n?void 0:n._debugSource)||void 0===c?void 0:c.fileName,linenumber:null===(u=null==n?void 0:n._debugSource)||void 0===u?void 0:u.lineNumber,props:d,componentName:"Component"===v?null===(s=null===(a=null==n?void 0:n._debugSource)||void 0===a?void 0:a.fileName)||void 0===s?void 0:s.split("\\").pop().split("/").pop().split(".")[0]:v}),e(null==n?void 0:n._debugOwner,t-1,o)}return e(null==n?void 0:n._debugOwner,t-1,o)},n.getComponentProps=r,n.getComponentName=i;var l={mouseup:!0,mousedown:!0,mousemove:!0,mouseover:!0};function c(e){for(var n in e)if(e[n]&&"[object Function]"==={}.toString.call(e[n]))try{e[n]="[Function]"}catch(e){console.error("Error stringifying prop",e)}!function(e){for(var n=Object.keys(e),t=0,o=n;t<o.length;t++){var r=o[t];"[object Object]"!==Object.prototype.toString.call(e[r])||!e[r].hasOwnProperty("_owner")&&"inputRef"!==r&&"InputProps"!==r||delete e[r]}}(e)}n.getCoordinates=function(e){var n=e;return l[e.type]?{x:n.clientX,y:n.clientY}:null},n.findReactElementDURKA=function(e){var n=Object.keys(e).find((function(e){return e.startsWith("__reactInternalInstance$")})),t=n?e[n]:null;return null==t?null:t},n.findReactElement=function(e){var n=e;for(var t in n)if(t.startsWith("__reactInternalInstance$"))return n[t];return null},n.functionStringify=c},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){var n=this;this.recordEvents=[],this.reconcileEvents=["blur","focus","change"],this.addAllListeners=function(){n.recordEvents.forEach((function(e){window.addEventListener(e,n.eventCallback,!0)})),n.reconcileEvents.forEach((function(e){window.addEventListener(e,n.reconcileCallback,!0)}))},this.removeAllListeners=function(){n.recordEvents.forEach((function(e){window.removeEventListener(e,n.eventCallback,!0)})),n.reconcileEvents.forEach((function(e){window.removeEventListener(e,n.reconcileCallback,!0)}))},this.start=function(){window.recorderAddedControlListeners||(n.addAllListeners(),window.recorderAddedControlListeners=!0)},this.stop=function(){window.recorderAddedControlListeners&&(n.removeAllListeners(),window.recorderAddedControlListeners=!1)};var t=e.eventCallback,o=e.reconcileCallback,r=e.recordEvents,i=e.reconcileEvents,l=void 0===i?null:i;this.eventCallback=t,this.reconcileCallback=o,this.recordEvents=r,l&&(this.reconcileEvents=l)};n.default=o}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NsaWVudC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2V2ZW50LXJlY29yZGVyLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiZXZlbnRzVG9SZWNvcmQiLCJjb21wb25lbnRFdmVudENhY2hlIiwicHJldmlvdXNDb21wb25lbnQiLCJwcmV2aW91c01zZyIsInN0YXJ0IiwiZXZlbnRSZWNvcmRlciIsInN0b3AiLCJjbGVhckV2ZW50Q2FjaGUiLCJyZWNvbmNpbGVFdmVudENhY2hlIiwiZXZlbnQiLCJ0YXJnZXQiLCJmaW5kUmVhY3RFbGVtZW50IiwiZm9yRWFjaCIsIm1zZyIsImNvbnNvbGUiLCJsb2ciLCJzZW5kRXZlbnQiLCJjcmVhdGVQb3B1cE1lbnUiLCJtZXNzYWdlIiwiZGl2SUQiLCJEYXRlIiwiZ2V0VGltZSIsIm1vdXNlRXZlbnQiLCJtZW51RGl2IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwicHJldmlvdXNNZW51cyIsIkFycmF5IiwiZnJvbSIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJtYXAiLCJ2YWwiLCJyZW1vdmUiLCJzZXRBdHRyaWJ1dGUiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJzdHlsZSIsInBvc2l0aW9uIiwibGVmdCIsIngiLCJ0b3AiLCJ5IiwiekluZGV4IiwiY29tcG9uZW50SW5mbyIsImJ0biIsIndpZHRoIiwiaW5uZXJIVE1MIiwiY29tcG9uZW50TmFtZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjb21wb25lbnRNZW51Q2xpY2siLCJiciIsIkNhbmNlbEJ0biIsInJlbW92ZVNpbmdsZU1lbnUiLCJnZXRFbGVtZW50QnlJZCIsInNlbGVjdGVkQ29tcG9uZW50IiwicmVkdWNlIiwiYWNjIiwiY3VyciIsInN0b3BQcm9wYWdhdGlvbiIsInRoZW4iLCJyZXMiLCJnZXRNZXNzYWdlIiwicmVhY3RDb21wb25lbnQiLCJzcmNFbGVtZW50IiwiaW5wdXRUYXJnZXQiLCJsaW5rVGFyZ2V0IiwiZ2V0Q29tcG9uZW50SW5mbyIsImNsaWNrSGFuZGxlciIsInNsaWNlIiwicmV2ZXJzZSIsImFjY3VtdWxhdG9yIiwiY3VycmVudFZhbHVlIiwicHJvcHMiLCJvbkNsaWNrIiwiYWN0aW9uIiwidHlwZSIsImNoZWNrZWQiLCJjb29yZGluYXRlcyIsImdldENvb3JkaW5hdGVzIiwiaHJlZiIsImtleUNvZGUiLCJ0YWdOYW1lIiwidGFnVHlwZSIsInRleHRDb250ZW50IiwiaW5uZXJUZXh0IiwidGltZXN0YW1wIiwid3JpdGVUZXN0TG9jYXRpb24iLCJjbGlja0hhbmRsZXJDb21wb25lbnQiLCJyZWNvcmRFdmVudCIsIm5vZGVUYXJnZXQiLCJwYXJlbnRFbGVtZW50IiwiZ2V0QXR0cmlidXRlIiwiaW5jbHVkZXMiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsIm1ldGFLZXkiLCJlIiwiZXJyb3IiLCJhY2NvdW50SWQiLCJ3aW5kb3ciLCJmZXRjaCIsIm1ldGhvZCIsImNhY2hlIiwiY3JlZGVudGlhbHMiLCJoZWFkZXJzIiwidXJsIiwibG9jYXRpb24iLCJwbGFjZWhvbGRlciIsImpzb24iLCJ0aGlzIiwicmVjb3JkRXZlbnRzIiwiZXZlbnRDYWxsYmFjayIsInJlY29uY2lsZUNhbGxiYWNrIiwiQXNzZXJ0bHlDbGllbnQiLCJnZXRDb21wb25lbnRQcm9wcyIsImNvbXBvbmVudCIsImZ1bmN0aW9uU3RyaW5naWZ5IiwibmV3UHJvcHMiLCJwZW5kaW5nUHJvcHMiLCJjaGlsZHJlbiIsIl9fcHJvdG9fXyIsIl9kZWJ1Z093bmVyIiwiZ2V0Q29tcG9uZW50TmFtZSIsImZpYmVyIiwiZWxlbWVudFR5cGUiLCJkaXNwbGF5TmFtZSIsIm1heE5lc3QiLCJyZXN1bHRBcnJheSIsIl9kZWJ1Z1NvdXJjZSIsImZpbGVOYW1lIiwicHVzaCIsImZpbGVuYW1lIiwibGluZW51bWJlciIsImxpbmVOdW1iZXIiLCJzcGxpdCIsInBvcCIsImV2ZW50c1dpdGhDb29yZGluYXRlcyIsIm1vdXNldXAiLCJtb3VzZWRvd24iLCJtb3VzZW1vdmUiLCJtb3VzZW92ZXIiLCJvYmoiLCJrIiwidG9TdHJpbmciLCJrZXlzIiwic3RyaXBFeHRyYUNvbXBvbmVudFByb3BzIiwiY2xpZW50WCIsImNsaWVudFkiLCJmaW5kIiwic3RhcnRzV2l0aCIsImludGVybmFsSW5zdGFuY2UiLCJ0YXJnZXRNYXAiLCJjb25maWciLCJyZWNvbmNpbGVFdmVudHMiLCJhZGRBbGxMaXN0ZW5lcnMiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicmVjb3JkZXJBZGRlZENvbnRyb2xMaXN0ZW5lcnMiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtm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LDRCQUVqQixPQUFPRSxFQUFVbEssR0FHckIsT0FBTyxNQUlULHVCLDhFQ2hJQSxNQU1FLFNBQVltSyxHQUFaLFdBSFEsS0FBQTFDLGFBQTRCLEdBQzVCLEtBQUEyQyxnQkFBbUMsQ0FBQyxPQUFRLFFBQVMsVUFpQjdELEtBQUFDLGdCQUFrQixXQUNoQixFQUFLNUMsYUFBYXBHLFNBQVEsU0FBQ0gsR0FDekI0RixPQUFPckQsaUJBQWlCdkMsRUFBTyxFQUFLd0csZUFBZSxNQUdyRCxFQUFLMEMsZ0JBQWdCL0ksU0FBUSxTQUFDSCxHQUM1QjRGLE9BQU9yRCxpQkFBaUJ2QyxFQUFPLEVBQUt5RyxtQkFBbUIsT0FJM0QsS0FBQTJDLG1CQUFxQixXQUNuQixFQUFLN0MsYUFBYXBHLFNBQVEsU0FBQ0gsR0FDekI0RixPQUFPeUQsb0JBQW9CckosRUFBTyxFQUFLd0csZUFBZSxNQUV4RCxFQUFLMEMsZ0JBQWdCL0ksU0FBUSxTQUFDSCxHQUM1QjRGLE9BQU95RCxvQkFBb0JySixFQUFPLEVBQUt5RyxtQkFBbUIsT0FJOUQsS0FBQTlHLE1BQVEsV0FDRGlHLE9BQU8wRCxnQ0FDVixFQUFLSCxrQkFDTHZELE9BQU8wRCwrQkFBZ0MsSUFJM0MsS0FBQXpKLEtBQU8sV0FDRCtGLE9BQU8wRCxnQ0FDVCxFQUFLRixxQkFDTHhELE9BQU8wRCwrQkFBZ0MsSUExQ3ZDLElBQUE5QyxFQUlFeUMsRUFBTSxjQUhSeEMsRUFHRXdDLEVBQU0sa0JBRlIxQyxFQUVFMEMsRUFBTSxhQURSLEVBQ0VBLEVBQU0sZ0JBRFJDLE9BQWUsSUFBRyxPQUFJLEVBRXhCNUMsS0FBS0UsY0FBZ0JBLEVBQ3JCRixLQUFLRyxrQkFBb0JBLEVBQ3pCSCxLQUFLQyxhQUFlQSxFQUNoQjJDLElBQ0Y1QyxLQUFLNEMsZ0JBQWtCQSxJIiwiZmlsZSI6ImFzc2VydGx5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0IHtcbiAgZmluZFJlYWN0RWxlbWVudCxcbiAgZ2V0Q29vcmRpbmF0ZXMsXG4gIGdldENvbXBvbmVudE5hbWUsXG4gIGdldENvbXBvbmVudFByb3BzLFxuICBnZXRDb21wb25lbnRJbmZvXG59IGZyb20gXCIuL3V0aWxzXCI7XG5cblxuaW1wb3J0IEV2ZW50UmVjb3JkZXIgZnJvbSBcIi4vZXZlbnQtcmVjb3JkZXJcIjtcbmltcG9ydCBDbGllbnRJbnRlcmZhY2UgZnJvbSBcIi4vdHlwZXMvQ2xpZW50XCI7XG5pbXBvcnQgTWVzc2FnZSBmcm9tIFwiLi90eXBlcy9NZXNzYWdlXCI7XG5pbXBvcnQgeyBFdmVudFR5cGUgfSBmcm9tIFwiLi90eXBlcy9FdmVudFR5cGVcIjtcblxuaW50ZXJmYWNlIENvbXBvbmVudCB7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFzc2VydGx5Q2xpZW50IGltcGxlbWVudHMgQ2xpZW50SW50ZXJmYWNlIHtcbiAgZXZlbnRzVG9SZWNvcmQ6IEV2ZW50VHlwZVtdID0gW1wiY2xpY2tcIiwgXCJjaGFuZ2VcIl07XG5cbiAgcHJpdmF0ZSBldmVudFJlY29yZGVyOiBFdmVudFJlY29yZGVyO1xuICBwcml2YXRlIGNvbXBvbmVudEV2ZW50Q2FjaGU6IE1lc3NhZ2VbXSA9IFtdO1xuICBwcml2YXRlIHByZXZpb3VzQ29tcG9uZW50OiBDb21wb25lbnQgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBwcmV2aW91c01zZzogTWVzc2FnZSB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZXZlbnRSZWNvcmRlciA9IG5ldyBFdmVudFJlY29yZGVyKHtcbiAgICAgIHJlY29yZEV2ZW50czogdGhpcy5ldmVudHNUb1JlY29yZCxcbiAgICAgIGV2ZW50Q2FsbGJhY2s6IHRoaXMucmVjb3JkRXZlbnQsXG4gICAgICByZWNvbmNpbGVDYWxsYmFjazogdGhpcy5yZWNvbmNpbGVFdmVudENhY2hlLFxuICAgIH0pO1xuICB9XG5cbiAgc3RhcnQgPSAoKSA9PiB7XG4gICAgdGhpcy5ldmVudFJlY29yZGVyLnN0YXJ0KCk7XG4gIH07XG5cbiAgc3RvcCA9ICgpID0+IHtcbiAgICB0aGlzLmV2ZW50UmVjb3JkZXIuc3RvcCgpO1xuICB9O1xuXG4gIGNsZWFyRXZlbnRDYWNoZSA9ICgpID0+IHtcbiAgICB0aGlzLmNvbXBvbmVudEV2ZW50Q2FjaGUgPSBbXTtcbiAgfTtcblxuICByZWNvbmNpbGVFdmVudENhY2hlID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuICAgIGNvbnN0IHJlYWN0Q29tcG9uZW50ID0gZXZlbnQudGFyZ2V0ID8gZmluZFJlYWN0RWxlbWVudChldmVudC50YXJnZXQpIDogbnVsbDtcbiAgICBpZiAocmVhY3RDb21wb25lbnQgIT09IHRoaXMucHJldmlvdXNDb21wb25lbnQpIHtcbiAgICAgIHRoaXMuY29tcG9uZW50RXZlbnRDYWNoZS5mb3JFYWNoKChtc2cpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2luIHRoZSByZWNvbmNpbGUnKTtcbiAgICAgICAgdGhpcy5zZW5kRXZlbnQobXNnKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5jbGVhckV2ZW50Q2FjaGUoKTtcbiAgICB9XG4gIH07XG5cbiAgY3JlYXRlUG9wdXBNZW51ID0gKG1lc3NhZ2U6IE1lc3NhZ2UpID0+IHtcblxuICAgIGNvbnN0IGV2ZW50VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIGNvbnN0IGRpdklEID0gXCJjb21wb25lbnRNZW51XCIgKyBldmVudFRpbWU7XG4gICAgY29uc3QgbW91c2VFdmVudCA9IGV2ZW50IGFzIE1vdXNlRXZlbnQ7XG4gICAgY29uc3QgbWVudURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJESVZcIik7XG5cbiAgICBjb25zdCBwcmV2aW91c01lbnVzID0gQXJyYXkuZnJvbShkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjb21wb25lbnRNZW51JykpO1xuICAgIHByZXZpb3VzTWVudXM/Lm1hcCgodmFsOiBhbnkpID0+IHZhbC5yZW1vdmUoKSk7XG5cbiAgICBtZW51RGl2LnNldEF0dHJpYnV0ZShcImlkXCIsIGRpdklEKTtcbiAgICBtZW51RGl2LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsICdjb21wb25lbnRNZW51Jyk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtZW51RGl2KTtcbiAgICBtZW51RGl2LnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgIG1lbnVEaXYuc3R5bGUubGVmdCA9IG1vdXNlRXZlbnQueCArICdweCc7XG4gICAgbWVudURpdi5zdHlsZS50b3AgPSBtb3VzZUV2ZW50LnkgKyAncHgnO1xuXG4gICAgLy8gbmVlZHMgdG8gZ28gb24gdG9wIG9mIGFueSBvdGhlciBleGlzdGluZyBtb2RhbFxuICAgIG1lbnVEaXYuc3R5bGUuekluZGV4ID0gJzk5OTk5OTk5OTk5OTknO1xuXG4gICAgbWVzc2FnZT8uY29tcG9uZW50SW5mbz8ubWFwKCh2YWw6IGFueSkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJidXR0b24gdmFsOiBcIiwgdmFsKTtcbiAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJCVVRUT05cIik7XG4gICAgICBidG4uc3R5bGUud2lkdGggPSAnMTUwcHgnO1xuICAgICAgYnRuLmlubmVySFRNTCA9IHZhbD8uY29tcG9uZW50TmFtZTtcbiAgICAgIGlmIChidG4uaW5uZXJIVE1MKSB7XG4gICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuY29tcG9uZW50TWVudUNsaWNrKGV2ZW50LCBkaXZJRCwgbWVzc2FnZSkpO1xuICAgICAgICBtZW51RGl2LmFwcGVuZENoaWxkKGJ0bik7XG4gICAgICAgIGNvbnN0IGJyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJyXCIpO1xuICAgICAgICBtZW51RGl2LmFwcGVuZENoaWxkKGJyKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IENhbmNlbEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJCVVRUT05cIik7XG4gICAgQ2FuY2VsQnRuLnN0eWxlLndpZHRoID0gJzE1MHB4JztcbiAgICBDYW5jZWxCdG4uaW5uZXJIVE1MID0gJ0NhbmNlbCc7XG4gICAgQ2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5yZW1vdmVTaW5nbGVNZW51KGRpdklEKSk7XG4gICAgbWVudURpdi5hcHBlbmRDaGlsZChDYW5jZWxCdG4pO1xuICB9O1xuXG4gIHJlbW92ZVNpbmdsZU1lbnUgPSAoZGl2SUQ6IGFueSkgPT4ge1xuICAgIGNvbnN0IG1lbnVEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkaXZJRCk7XG4gICAgbWVudURpdj8ucmVtb3ZlKCk7XG4gIH07XG5cbiAgY29tcG9uZW50TWVudUNsaWNrID0gKGV2ZW50OiBhbnksIGRpdklEOiBhbnksIG1lc3NhZ2U6IE1lc3NhZ2UpOiBhbnkgPT4ge1xuICAgIC8vIGNvbnNvbGUubG9nKCd0aGlzIGlzIHRoZSBjbGljayBjYWxsIGJhY2s6ICcsIGV2ZW50KVxuXG4gICAgY29uc3Qgc2VsZWN0ZWRDb21wb25lbnQgPSBtZXNzYWdlLmNvbXBvbmVudEluZm8/LnJlZHVjZShcbiAgICAgIChhY2M6IGFueSwgY3VycjogYW55KSA9PiB7XG4gICAgICAgIGlmIChjdXJyLmNvbXBvbmVudE5hbWUgPT09IGV2ZW50LnRhcmdldD8uaW5uZXJIVE1MKSB7XG4gICAgICAgICAgcmV0dXJuIHsuLi5jdXJyfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9XG4gICAgICB9LCBudWxsKTtcblxuICAgIGV2ZW50Py5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB0aGlzLnNlbmRFdmVudCh7XG4gICAgICAuLi5tZXNzYWdlLFxuICAgICAgLy8gdGhlcmUgc2hvdWxkIG9ubHkgYmUgb25lIG1hdGNoIGhlcmUgb24gdGhlIGZpbHRlclxuICAgICAgLy8gY29tcG9uZW50SW5mbzogbWVzc2FnZS5jb21wb25lbnRJbmZvPy5maWx0ZXIoICh2YWw6YW55KSA9PiB2YWwuY29tcG9uZW50TmFtZSA9PT0gZXZlbnQudGFyZ2V0Py5pbm5lckhUTUwpXG4gICAgICBjb21wb25lbnRJbmZvOiBzZWxlY3RlZENvbXBvbmVudFxuICAgIH0pLnRoZW4ocmVzID0+IHtjb25zb2xlLmxvZygnZG90IHRoZW4nLCByZXMpfSk7XG5cbiAgICB0aGlzLnJlbW92ZVNpbmdsZU1lbnUoZGl2SUQpO1xuICAgIC8vIGNvbnN0IG1lbnVEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkaXZJRCk7XG4gICAgLy8gbWVudURpdj8ucmVtb3ZlKClcblxuICB9O1xuXG4gIGdldE1lc3NhZ2UgPSAocmVhY3RDb21wb25lbnQ6IGFueSwgZXZlbnQ6IEtleWJvYXJkRXZlbnQgfCBFdmVudCk6IE1lc3NhZ2UgPT4ge1xuXG4gICAgLy8gZnVuY3Rpb24gdG8gdXNlIGluIGFycmF5IHJlZHVjZVxuICAgIGNvbnN0IGZpbmRDbGlja0hhbmRsZXIgPSAoYWNjdW11bGF0b3I6IGFueSwgY3VycmVudFZhbHVlOiBhbnkpID0+IHtcbiAgICAgIGlmIChjdXJyZW50VmFsdWUucHJvcHM/Lm9uQ2xpY2spIHtcbiAgICAgICAgcmV0dXJuIHsuLi5jdXJyZW50VmFsdWV9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQgfHwgZXZlbnQuc3JjRWxlbWVudDtcbiAgICBjb25zdCBpbnB1dFRhcmdldCA9IHRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIGNvbnN0IGxpbmtUYXJnZXQgPSB0YXJnZXQgYXMgSFRNTExpbmtFbGVtZW50O1xuXG4gICAgY29uc3QgY29tcG9uZW50SW5mbyA9IGdldENvbXBvbmVudEluZm8ocmVhY3RDb21wb25lbnQsIDEwLCBbXSk7XG5cbiAgICAvLyBmaW5kIHRoZSBjbG9zZXN0IGNsaWNrIGhhbmRsZXIgdGhhdCB3b3VsZCBoYXZlIGJlZW4gdHJpZ2dlcmVkXG4gICAgY29uc3QgY2xpY2tIYW5kbGVyID0gY29tcG9uZW50SW5mbz8uc2xpY2UoMCk/LnJldmVyc2UoKT8ucmVkdWNlKGZpbmRDbGlja0hhbmRsZXIsIG51bGwpO1xuXG5cbiAgICAvLyBjb25zb2xlLmxvZygnY29tcG9uZW50IGluZm8gaW4gR0VUX01FU1NBR0U6ICcsIGNvbXBvbmVudEluZm8sIGNsaWNrSGFuZGxlcilcblxuICAgIGNvbnN0IG1lc3NhZ2U6IE1lc3NhZ2UgPSB7XG4gICAgICAvLyBjb21wb25lbnROYW1lLCBmaWxlTmFtZSwgYW5kIGxpbmVOdW1iZXIgYXJlIGFscmVhZHkgaW4gdGhlIG9iamVjdCByZXR1cm5lZFxuICAgICAgYWN0aW9uOiBldmVudC50eXBlLFxuICAgICAgY2hlY2tlZDogZXZlbnQ/LnRhcmdldD8uaGFzT3duUHJvcGVydHkoXCJjaGVja2VkXCIpXG4gICAgICAgID8gaW5wdXRUYXJnZXQuY2hlY2tlZFxuICAgICAgICA6IG51bGwsXG4gICAgICBjb29yZGluYXRlczogZ2V0Q29vcmRpbmF0ZXMoZXZlbnQpLFxuICAgICAgaHJlZjogbGlua1RhcmdldC5ocmVmID8gbGlua1RhcmdldC5ocmVmIDogbnVsbCxcbiAgICAgIGtleUNvZGU6IChldmVudCBhcyBLZXlib2FyZEV2ZW50KS5rZXlDb2RlXG4gICAgICAgID8gKGV2ZW50IGFzIEtleWJvYXJkRXZlbnQpLmtleUNvZGVcbiAgICAgICAgOiBudWxsLFxuICAgICAgdGFnTmFtZTogaW5wdXRUYXJnZXQudGFnTmFtZSxcbiAgICAgIHRhZ1R5cGU6IGlucHV0VGFyZ2V0LnR5cGUsXG4gICAgICB0ZXh0Q29udGVudDogaW5wdXRUYXJnZXQudGV4dENvbnRlbnQgfHwgaW5wdXRUYXJnZXQuaW5uZXJUZXh0LFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcbiAgICAgIHZhbHVlOiBpbnB1dFRhcmdldC52YWx1ZSxcbiAgICAgIHdyaXRlVGVzdExvY2F0aW9uOiAnJyxcbiAgICAgIGNvbXBvbmVudEluZm86IGNvbXBvbmVudEluZm8sXG4gICAgICBjbGlja0hhbmRsZXJDb21wb25lbnQ6IGNsaWNrSGFuZGxlclxuXG4gICAgfTtcblxuICAgIHJldHVybiBtZXNzYWdlO1xuICB9O1xuXG5cbiAgcmVjb3JkRXZlbnQgPSAoZXZlbnQ6IEV2ZW50KSA9PiB7XG4gICAgY29uc3Qgbm9kZVRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBOb2RlO1xuICAgIGNvbnN0IG1vdXNlRXZlbnQgPSBldmVudCBhcyBNb3VzZUV2ZW50O1xuXG4gICAgLy8gaWYgdGhlIGNsaWNrIGlzIG9uIGEgbWVudSB0aGF0IHBvcHMgdXAsIGRvbnQgZ28gdGhyb3VnaCB0aGUgcmVjb3JkIGV2ZW50IGxvZ2ljXG4gICAgaWYgKG5vZGVUYXJnZXQ/LnBhcmVudEVsZW1lbnQ/LmdldEF0dHJpYnV0ZShcImlkXCIpPy5pbmNsdWRlcygnY29tcG9uZW50TWVudScpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghZXZlbnQudGFyZ2V0KSByZXR1cm47XG5cbiAgICB0cnkge1xuICAgICAgaWYgKHRoaXMucHJldmlvdXNNc2cpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIChldmVudC50eXBlID09PSBcImNoYW5nZVwiIHx8IGV2ZW50LnR5cGUgPT09IFwiY2xpY2tcIikgJiZcbiAgICAgICAgICB0aGlzLnByZXZpb3VzTXNnICYmXG4gICAgICAgICAgdGhpcy5wcmV2aW91c01zZy5hY3Rpb24gPT09IFwiY2xpY2tcIiAmJlxuICAgICAgICAgIG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gdGhpcy5wcmV2aW91c01zZy50aW1lc3RhbXAgPCAxMDBcbiAgICAgICAgKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJtZXNzYWdlIG5vdCBzZW5kIGR1ZSB0byB0aW1lXCIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCByZWFjdENvbXBvbmVudCA9IGZpbmRSZWFjdEVsZW1lbnQoZXZlbnQudGFyZ2V0KTtcbiAgICAgIGNvbnN0IG1zZzogTWVzc2FnZSA9IHRoaXMuZ2V0TWVzc2FnZShyZWFjdENvbXBvbmVudCwgZXZlbnQpO1xuICAgICAgY29uc29sZS5sb2coJ3JlYWN0Q29tcG9uZW50IGFuZCBtZXNzYWdlIGluIFJFQ09SRF9FVkVOVDogJywgcmVhY3RDb21wb25lbnQsIG1zZyk7XG5cbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwibGFzdEV2ZW50XCIsIEpTT04uc3RyaW5naWZ5KG1zZykpO1xuICAgICAgdGhpcy5wcmV2aW91c01zZyA9IG1zZztcblxuICAgICAgLy8gaWYgKFxuICAgICAgLy8gICAvLyBpZiB0aGVyZSBpcyBubyBwcmV2aW91cyBjb21wb25lbnQgb3IgdGhlIHByZXZpb3VzIGNvbXBvbmVudCBpcyB0aGUgc2FtZSBhcyB0aGUgY29tcG9uZW50IHlvdSBqdXN0IGNsaWNrZWQgb25cbiAgICAgIC8vICAgIXRoaXMucHJldmlvdXNDb21wb25lbnQgfHxcbiAgICAgIC8vICAgKHRoaXMucHJldmlvdXNDb21wb25lbnQgJiYgdGhpcy5wcmV2aW91c0NvbXBvbmVudCA9PT0gcmVhY3RDb21wb25lbnQpXG4gICAgICAvLyApIHtcbiAgICAgIC8vICAgdGhpcy5wcmV2aW91c0NvbXBvbmVudCA9IHJlYWN0Q29tcG9uZW50O1xuICAgICAgLy8gICBpZiAoXG4gICAgICAvLyAgICAgdGhpcy5wcmV2aW91c0NvbXBvbmVudCAmJlxuICAgICAgLy8gICAgIG1zZy5jaGVja2VkICE9PSBudWxsICYmXG4gICAgICAvLyAgICAgbXNnLmFjdGlvbiA9PT0gXCJjbGlja1wiXG4gICAgICAvLyAgICkge1xuICAgICAgLy8gICAgIC8vIG1lc3NhZ2UgaXMgc2VudCB3aGVuIHNvbWV0aGluZyBpbiB0aGUgcG9wdXAgbWVudSBpcyBzZWxlY3RlZFxuICAgICAgLy8gICAgIHRoaXMuY3JlYXRlUG9wdXBNZW51KG1zZyk7XG4gICAgICAvLyAgICAgLy8gdGhpcy5zZW5kRXZlbnQobXNnKTtcbiAgICAgIC8vICAgICByZXR1cm47XG4gICAgICAvLyAgIH1cblxuICAgICAgLy8gICAvL3B1c2hpbmcgYSBtZXNzYWdlIHRvIHRoZSBldmVudCBjYWNoZSBzZW5kcyBpdCB0byB0aGUgYXBpIHdoZW4gdGhlIHJlY29uY2lsZSBjYWxsYmFjayBpcyBjYWxsZWRcbiAgICAgIC8vICAgdGhpcy5jb21wb25lbnRFdmVudENhY2hlLnB1c2gobXNnKTtcblxuICAgICAgLy8gICByZXR1cm47XG4gICAgICAvLyB9IGVsc2Uge1xuICAgICAgLy8gICB0aGlzLmNsZWFyRXZlbnRDYWNoZSgpO1xuICAgICAgLy8gfVxuXG4gICAgICB0aGlzLnByZXZpb3VzQ29tcG9uZW50ID0gcmVhY3RDb21wb25lbnQ7XG5cbiAgICAgIC8vIG1lc3NhZ2UgaXMgc2VudCB3aGVuIHNvbWV0aGluZyBpbiB0aGUgcG9wdXAgbWVudSBpcyBzZWxlY3RlZFxuICAgICAgaWYgKG1vdXNlRXZlbnQ/Lm1ldGFLZXkpIHRoaXMuY3JlYXRlUG9wdXBNZW51KG1zZyk7XG4gICAgICAvLyB0aGlzLnNlbmRFdmVudChtc2cpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZWNvcmRpbmcgZXZlbnRcIiwgZSk7XG4gICAgfVxuICB9O1xuXG4gIHNlbmRFdmVudCA9IGFzeW5jIChtZXNzYWdlOiBNZXNzYWdlKSA9PiB7XG4gICAgbGV0IGFjY291bnRJZCA9ICh3aW5kb3cgYXMgeyBba2V5OiBzdHJpbmddOiBhbnkgfSlbXCJkYXRhTGF5ZXJcIl1bMF1bXCJhcGlLZXlcIl07XG5cbiAgICAvLyByYXRoZXIgZ2V0IGEgNDAzIHRoYW4gYSBiYWQgcm91dGVcbiAgICBpZiAoIWFjY291bnRJZCkge1xuICAgICAgYWNjb3VudElkID0gMTtcbiAgICB9XG5cbiAgICBjb25zdCB1cmwgPSBgLy9sb2NhbGhvc3Q6MzAyMC9hcGkvYWNjb3VudHMvJHthY2NvdW50SWR9L2V2ZW50cy9gO1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBtb2RlOiBcImNvcnNcIixcbiAgICAgIGNhY2hlOiBcIm5vLWNhY2hlXCIsXG4gICAgICBjcmVkZW50aWFsczogXCJzYW1lLW9yaWdpblwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHVybDogd2luZG93LmxvY2F0aW9uLmhyZWYsXG4gICAgICAgIGV2ZW50OiBtZXNzYWdlLFxuICAgICAgICAvLyBUT0RPOiB0ZXN0IHNldCBpZCBzaG91bGQgYmUgc2V0IHdoZW4gY3JlYXRpbmcvbG9hZGluZyB0ZXN0c2V0IGluIHRoZSBydW5uZXJcbiAgICAgICAgcGxhY2Vob2xkZXI6IG51bGwsXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIHJldHVybiByZXNwb25zZS5qc29uKClcbiAgfTtcbn1cblxuKDxhbnk+d2luZG93KS5ldmVudFJlY29yZGVyID0gbmV3IEFzc2VydGx5Q2xpZW50KCk7XG4oPGFueT53aW5kb3cpLmV2ZW50UmVjb3JkZXIuc3RhcnQoKTtcblxuIiwiaW1wb3J0IENvb3JkaW5hdGVzIGZyb20gXCIuL3R5cGVzL0Nvb3JkaW5hdGVzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb21wb25lbnRJbmZvKGNvbXBvbmVudDogYW55LCBtYXhOZXN0OiBudW1iZXIsIHJlc3VsdEFycmF5OiBhbnkpOiBhbnkge1xuICBjb25zb2xlLmxvZygnZ2V0Q29tcG9uZW50SW5mbzogJywgY29tcG9uZW50LCByZXN1bHRBcnJheSlcblxuICBpZiAoIWNvbXBvbmVudCB8fCBtYXhOZXN0ID09PSAwKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ3Jlc3VsdEFycmF5OiAnLCByZXN1bHRBcnJheSlcbiAgICByZXR1cm4gcmVzdWx0QXJyYXlcbiAgfVxuXG4gIGlmIChjb21wb25lbnQ/Ll9kZWJ1Z1NvdXJjZT8uZmlsZU5hbWUpIHtcbiAgICAvLyB0aGUgb3duZXIgb2YgdGhlIG5vZGUgd2hlcmUgdGhlICdzb3VyY2UnIGZpbGVuYW1lIGV4aXN0cyBpcyB0aGUgZmlsZSB0aGF0IHlvdSB3YW50IHRoZSBwcm9wcyBmb3IgXG4gICAgY29uc3QgcHJvcHMgPSBnZXRDb21wb25lbnRQcm9wcyhjb21wb25lbnQ/Ll9kZWJ1Z093bmVyKVxuICAgIGNvbnN0IG5hbWUgPSBnZXRDb21wb25lbnROYW1lKGNvbXBvbmVudD8uX2RlYnVnT3duZXIpXG4gICAgcmVzdWx0QXJyYXkucHVzaCh7XG4gICAgICBmaWxlbmFtZTogY29tcG9uZW50Py5fZGVidWdTb3VyY2U/LmZpbGVOYW1lLCBcbiAgICAgIC8vIHRoZSBsaW5lIG51bWJlciBpcyByZWFsbHkgZm9yIHRoZSBuZXh0IGNvbXBvbmVudCBkb3duIGluIHRoZSB0cmVlIHRoYXQgaXMgYmVpbmcgY2FsbGVkIGZyb20gdGhlICdmaWxlbmFtZSdcbiAgICAgIGxpbmVudW1iZXI6IGNvbXBvbmVudD8uX2RlYnVnU291cmNlPy5saW5lTnVtYmVyLCBcbiAgICAgIHByb3BzOiBwcm9wcywgXG4gICAgICAvLyBpZiBpdCdzIGNvbXBvbmVudCAgc3RyLnNwbGl0KCdcXFxcJykucG9wLnNwbGl0KGAvYCkucG9wKCkuc3BsaXQoJy4nKVswXVxuICAgICAgY29tcG9uZW50TmFtZTogbmFtZSA9PT0gJ0NvbXBvbmVudCcgPyBcbiAgICAgICAgY29tcG9uZW50Py5fZGVidWdTb3VyY2U/LmZpbGVOYW1lPy5zcGxpdCgnXFxcXCcpLnBvcCgpLnNwbGl0KGAvYCkucG9wKCkuc3BsaXQoJy4nKVswXSA6IG5hbWVcbiAgICB9KVxuICAgIHJldHVybiBnZXRDb21wb25lbnRJbmZvKGNvbXBvbmVudD8uX2RlYnVnT3duZXIsbWF4TmVzdC0xLHJlc3VsdEFycmF5KVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBnZXRDb21wb25lbnRJbmZvKGNvbXBvbmVudD8uX2RlYnVnT3duZXIsbWF4TmVzdC0xLHJlc3VsdEFycmF5KVxuICB9XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbXBvbmVudFByb3BzKGNvbXBvbmVudDogYW55LCBwcm9wcyA9IHt9KTogYW55IHtcbiAgaWYgKCFjb21wb25lbnQpIHtcbiAgICBmdW5jdGlvblN0cmluZ2lmeShwcm9wcyk7XG4gICAgcmV0dXJuIHByb3BzO1xuICB9XG5cbiAgY29uc3QgbmV3UHJvcHMgPSBjb21wb25lbnQucGVuZGluZ1Byb3BzXG4gICAgPyB7IC4uLnByb3BzLCAuLi5jb21wb25lbnQucGVuZGluZ1Byb3BzIH1cbiAgICA6IHByb3BzO1xuICBkZWxldGUgbmV3UHJvcHMuY2hpbGRyZW47XG5cbiAgaWYgKFxuICAgIGNvbXBvbmVudD8udHlwZT8uX19wcm90b19fICYmXG4gICAgW1wiQ29tcG9uZW50XCIsIFwiUHVyZUNvbXBvbmVudFwiXS5pbmNsdWRlcyhjb21wb25lbnQudHlwZS5fX3Byb3RvX18ubmFtZSlcbiAgKSB7XG4gICAgZnVuY3Rpb25TdHJpbmdpZnkobmV3UHJvcHMpO1xuICAgIHJldHVybiBuZXdQcm9wcztcbiAgfVxuXG4gIHJldHVybiBnZXRDb21wb25lbnRQcm9wcyhjb21wb25lbnQuX2RlYnVnT3duZXIsIG5ld1Byb3BzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbXBvbmVudE5hbWUoZmliZXI6IGFueSk6IGFueSB7XG4gIGlmICghZmliZXIpIHJldHVybiBudWxsO1xuXG4gIGlmIChmaWJlci5lbGVtZW50VHlwZSAmJiBmaWJlci5lbGVtZW50VHlwZS5uYW1lKSB7XG4gICAgcmV0dXJuIGZpYmVyLmVsZW1lbnRUeXBlLm5hbWU7XG4gIH1cblxuICBpZiAoZmliZXIuZWxlbWVudFR5cGUgJiYgZmliZXIuZWxlbWVudFR5cGUuZGlzcGxheU5hbWUpIHtcbiAgICByZXR1cm4gZmliZXIuZWxlbWVudFR5cGUuZGlzcGxheU5hbWU7XG4gIH1cblxuICBpZiAoZmliZXIudHlwZS5kaXNwbGF5TmFtZSkge1xuICAgIHJldHVybiBmaWJlci50eXBlLmRpc3BsYXlOYW1lO1xuICB9XG5cbiAgaWYgKGZpYmVyLnR5cGUubmFtZSkge1xuICAgIHJldHVybiBmaWJlci50eXBlLm5hbWU7XG4gIH1cbiAgcmV0dXJuIGdldENvbXBvbmVudE5hbWUoZmliZXIuX2RlYnVnT3duZXIpO1xufVxuXG5jb25zdCBldmVudHNXaXRoQ29vcmRpbmF0ZXM6IHsgW2tleTogc3RyaW5nXTogYW55IH0gPSB7XG4gIG1vdXNldXA6IHRydWUsXG4gIG1vdXNlZG93bjogdHJ1ZSxcbiAgbW91c2Vtb3ZlOiB0cnVlLFxuICBtb3VzZW92ZXI6IHRydWUsXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29vcmRpbmF0ZXMoZXZlbnQ6IEV2ZW50KTogQ29vcmRpbmF0ZXMgfCBudWxsIHtcbiAgY29uc3QgbW91c2VFdmVudCA9IGV2ZW50IGFzIE1vdXNlRXZlbnQ7XG5cbiAgcmV0dXJuIGV2ZW50c1dpdGhDb29yZGluYXRlc1tldmVudC50eXBlXVxuICAgID8geyB4OiBtb3VzZUV2ZW50LmNsaWVudFgsIHk6IG1vdXNlRXZlbnQuY2xpZW50WSB9XG4gICAgOiBudWxsO1xufVxuXG4vLyBtYXAgcmVhY3QgY2xhc3NlcyB0byBkb20gZWxlbWVudHNcbmV4cG9ydCBmdW5jdGlvbiBmaW5kUmVhY3RFbGVtZW50RFVSS0EodGFyZ2V0OiBFdmVudFRhcmdldCk6IGFueSB7XG4gIC8vIGNvbnNvbGUuZGlyKHRhcmdldClcbiAgY29uc3Qga2V5ID0gT2JqZWN0LmtleXModGFyZ2V0KS5maW5kKChrZXkpID0+XG4gICAga2V5LnN0YXJ0c1dpdGgoXCJfX3JlYWN0SW50ZXJuYWxJbnN0YW5jZSRcIilcbiAgKTtcbiAgLy8gY29uc29sZS5sb2coJ2tleTogJywga2V5KVxuICAvLyBjcmVhdGVzIGFuIG9iamVjdCBvdXQgb2YgdGhlIHRhcmdldCBwYXNzZWRcbiAgY29uc3QgdGFyZ2V0TWFwID0gdGFyZ2V0IGFzIHsgW2tleTogc3RyaW5nXTogYW55IH07XG5cbiAgY29uc3QgaW50ZXJuYWxJbnN0YW5jZSA9IGtleSA/IHRhcmdldE1hcFtrZXldIDogbnVsbDtcbiAgLy8gY29uc29sZS5sb2coJ1JlYWN0IE5vZGUgaWYgRm91bmQ6ICcsIGludGVybmFsSW5zdGFuY2UpXG4gIGlmIChpbnRlcm5hbEluc3RhbmNlID09IG51bGwpIHJldHVybiBudWxsO1xuXG4gIC8vIGNvbnNvbGUubG9nKCdpbnRlcm5hbEluc3RhbmNlMjogJywgaW50ZXJuYWxJbnN0YW5jZSlcbiAgLy8gcmV0dXJuIGludGVybmFsSW5zdGFuY2UuX2RlYnVnT3duZXJcbiAgLy8gICA/IGludGVybmFsSW5zdGFuY2UuX2RlYnVnT3duZXIuc3RhdGVOb2RlXG4gIC8vICAgOiBpbnRlcm5hbEluc3RhbmNlLnJldHVybi5zdGF0ZU5vZGU7XG5cbiAgcmV0dXJuIGludGVybmFsSW5zdGFuY2U7XG5cbiAgLy8gZm9yIChsZXQga2V5OiBzdHJpbmcgaW4gdGFyZ2V0KSB7XG4gIC8vICAgaWYgKGtleS5zdGFydHNXaXRoKFwiX19yZWFjdEludGVybmFsSW5zdGFuY2UkXCIpKSB7XG4gIC8vICAgICAvLyBjb25zb2xlLmxvZygna2V5cyBpbiB0aGUgZmluZCBSZWFjdEVsZW1lbnQnLCB0YXJnZXRba2V5XSlcbiAgLy8gICAgIHJldHVybiB0YXJnZXRba2V5XTtcbiAgLy8gICB9XG4gIC8vIH1cbiAgLy8gcmV0dXJuIG51bGw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kUmVhY3RFbGVtZW50KHRhcmdldDogRXZlbnRUYXJnZXQpOiBhbnkge1xuICAvLyBjb25zdCBrZXkgPSBPYmplY3Qua2V5cyh0YXJnZXQpLmZpbmQoKGtleSkgPT5cbiAgLy8gICBrZXkuc3RhcnRzV2l0aChcIl9fcmVhY3RJbnRlcm5hbEluc3RhbmNlJFwiKVxuICAvLyApO1xuICBjb25zdCB0YXJnZXRNYXAgPSB0YXJnZXQgYXMgeyBba2V5OiBzdHJpbmddOiBhbnkgfTtcbiAgLy8gY29uc3QgaW50ZXJuYWxJbnN0YW5jZSA9IGtleSA/IHRhcmdldE1hcFtrZXldIDogbnVsbDtcbiAgLy8gaWYgKGludGVybmFsSW5zdGFuY2UgPT0gbnVsbCkgcmV0dXJuIG51bGw7XG4gIC8vIHJldHVybiBpbnRlcm5hbEluc3RhbmNlLl9kZWJ1Z093bmVyXG4gIC8vICAgPyBpbnRlcm5hbEluc3RhbmNlLl9kZWJ1Z093bmVyLnN0YXRlTm9kZVxuICAvLyAgIDogaW50ZXJuYWxJbnN0YW5jZS5yZXR1cm4uc3RhdGVOb2RlO1xuICBmb3IgKGxldCBrZXkgaW4gdGFyZ2V0TWFwKSB7XG4gICAgaWYgKGtleS5zdGFydHNXaXRoKFwiX19yZWFjdEludGVybmFsSW5zdGFuY2UkXCIpKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZygna2V5cyBpbiB0aGUgZmluZCBSZWFjdEVsZW1lbnQnLCB0YXJnZXRba2V5XSlcbiAgICAgIHJldHVybiB0YXJnZXRNYXBba2V5XTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGZ1bmN0aW9uU3RyaW5naWZ5KG9iajogYW55KTogdm9pZCB7XG4gIGZvciAobGV0IGsgaW4gb2JqKSB7XG4gICAgaWYgKG9ialtrXSAmJiB7fS50b1N0cmluZy5jYWxsKG9ialtrXSkgPT09IFwiW29iamVjdCBGdW5jdGlvbl1cIikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gb2JqW2tdID0gXCJcIiArIG9ialtrXTtcbiAgICAgICAgLy8gLy8gZ2V0IHJpZCBvZiB0aGUgZXh0cmEgbGluZSBtYXJrZXJzXG4gICAgICAgIC8vIG9ialtrXSA9IG9ialtrXS5yZXBsYWNlKC8oXFxyXFxufFxcbnxcXHIpL2dtLCBcIlwiKTtcbiAgICAgICAgb2JqW2tdID0gXCJbRnVuY3Rpb25dXCJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHN0cmluZ2lmeWluZyBwcm9wXCIsIGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBzdHJpcEV4dHJhQ29tcG9uZW50UHJvcHMob2JqKTtcbn1cblxuXG5cbmZ1bmN0aW9uIHN0cmlwRXh0cmFDb21wb25lbnRQcm9wcyhwcm9wczogYW55KTogdm9pZCB7XG4gIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhwcm9wcyk7XG4gIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICBpZiAoXG4gICAgICBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocHJvcHNba2V5XSkgPT09IFwiW29iamVjdCBPYmplY3RdXCIgJiZcbiAgICAgIChwcm9wc1trZXldLmhhc093blByb3BlcnR5KFwiX293bmVyXCIpIHx8XG4gICAgICAgIGtleSA9PT0gXCJpbnB1dFJlZlwiIHx8XG4gICAgICAgIGtleSA9PT0gXCJJbnB1dFByb3BzXCIpXG4gICAgKSB7XG4gICAgICBkZWxldGUgcHJvcHNba2V5XTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IEV2ZW50VHlwZSwgUmVjb25jaWxlVHlwZSB9IGZyb20gXCIuL3R5cGVzL0V2ZW50VHlwZVwiO1xuaW1wb3J0IHsgUmVjb3JkZXJDb25maWcgfSBmcm9tIFwiLi90eXBlcy9SZWNvcmRlckNvbmZpZ1wiO1xuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBXaW5kb3cge1xuICAgIHJlY29yZGVyQWRkZWRDb250cm9sTGlzdGVuZXJzOiBib29sZWFuO1xuICAgIGRhdGFMYXllcjogYW55W107XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXZlbnRSZWNvcmRlciB7XG4gIHByaXZhdGUgZXZlbnRDYWxsYmFjazogKGV2ZW50OiBFdmVudCkgPT4gYW55O1xuICBwcml2YXRlIHJlY29uY2lsZUNhbGxiYWNrOiAoZXZlbnQ6IEV2ZW50KSA9PiBhbnk7XG4gIHByaXZhdGUgcmVjb3JkRXZlbnRzOiBFdmVudFR5cGVbXSA9IFtdO1xuICBwcml2YXRlIHJlY29uY2lsZUV2ZW50czogUmVjb25jaWxlVHlwZVtdID0gW1wiYmx1clwiLCBcImZvY3VzXCIsIFwiY2hhbmdlXCJdO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogUmVjb3JkZXJDb25maWcpIHtcbiAgICBjb25zdCB7XG4gICAgICBldmVudENhbGxiYWNrLFxuICAgICAgcmVjb25jaWxlQ2FsbGJhY2ssXG4gICAgICByZWNvcmRFdmVudHMsXG4gICAgICByZWNvbmNpbGVFdmVudHMgPSBudWxsLFxuICAgIH0gPSBjb25maWc7XG4gICAgdGhpcy5ldmVudENhbGxiYWNrID0gZXZlbnRDYWxsYmFjaztcbiAgICB0aGlzLnJlY29uY2lsZUNhbGxiYWNrID0gcmVjb25jaWxlQ2FsbGJhY2s7XG4gICAgdGhpcy5yZWNvcmRFdmVudHMgPSByZWNvcmRFdmVudHM7XG4gICAgaWYgKHJlY29uY2lsZUV2ZW50cykge1xuICAgICAgdGhpcy5yZWNvbmNpbGVFdmVudHMgPSByZWNvbmNpbGVFdmVudHM7XG4gICAgfVxuICB9XG5cbiAgYWRkQWxsTGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMucmVjb3JkRXZlbnRzLmZvckVhY2goKGV2ZW50KSA9PiB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5ldmVudENhbGxiYWNrLCB0cnVlKTtcbiAgICB9KTtcblxuICAgIHRoaXMucmVjb25jaWxlRXZlbnRzLmZvckVhY2goKGV2ZW50KSA9PiB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5yZWNvbmNpbGVDYWxsYmFjaywgdHJ1ZSk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmVtb3ZlQWxsTGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHRoaXMucmVjb3JkRXZlbnRzLmZvckVhY2goKGV2ZW50KSA9PiB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgdGhpcy5ldmVudENhbGxiYWNrLCB0cnVlKTtcbiAgICB9KTtcbiAgICB0aGlzLnJlY29uY2lsZUV2ZW50cy5mb3JFYWNoKChldmVudDogUmVjb25jaWxlVHlwZSkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIHRoaXMucmVjb25jaWxlQ2FsbGJhY2ssIHRydWUpO1xuICAgIH0pO1xuICB9O1xuXG4gIHN0YXJ0ID0gKCkgPT4ge1xuICAgIGlmICghd2luZG93LnJlY29yZGVyQWRkZWRDb250cm9sTGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLmFkZEFsbExpc3RlbmVycygpO1xuICAgICAgd2luZG93LnJlY29yZGVyQWRkZWRDb250cm9sTGlzdGVuZXJzID0gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgc3RvcCA9ICgpID0+IHtcbiAgICBpZiAod2luZG93LnJlY29yZGVyQWRkZWRDb250cm9sTGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgd2luZG93LnJlY29yZGVyQWRkZWRDb250cm9sTGlzdGVuZXJzID0gZmFsc2U7XG4gICAgfVxuICB9O1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==